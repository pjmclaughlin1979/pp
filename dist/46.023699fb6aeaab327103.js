(function(){(this||window).webpackJsonp.registerAbsMids({"esri/core/HandleOwner":1503,"esri/views/layers/LayerView":1504,"esri/views/3d/layers/LayerView3D":1507,"esri/views/3d/layers/support/projectExtentUtils":1534,"esri/layers/graphics/data/QueryEngineCapabilities":1545,"esri/views/3d/webgl-engine/lib/HighlightSet":1551,"esri/core/libs/rbush/PooledRBush":1558,"esri/views/3d/layers/graphics/Graphics3DFrustumVisibility":1574,"esri/views/3d/layers/graphics/constants":1575,"esri/views/3d/layers/graphics/Graphics3DCore":1576,"esri/renderers/support/rendererConversion":1577,"esri/views/3d/layers/graphics/Graphics3DSymbolCreationContext":1578,"esri/views/3d/layers/graphics/Graphics3DSymbolFactory":1579,"esri/views/3d/layers/graphics/Graphics3DPointSymbol":1580,"esri/views/3d/layers/graphics/Graphics3DElevationAlignment":1581,"esri/views/3d/layers/graphics/Graphics3DHighlights":1582,"esri/views/3d/layers/graphics/Graphics3DHighlightSet":1583,"esri/views/3d/layers/graphics/Graphics3DScaleVisibility":1584,"esri/views/3d/layers/graphics/Graphics3DSpatialIndex":1585,"esri/views/3d/layers/support/attributeUtils":1596,"esri/renderers/support/renderingInfoUtils":1636,"esri/views/3d/layers/graphics/Graphics3DFeatureLikeLayerView":1637,"esri/views/3d/layers/graphics/Graphics3DFilterVisibility":1638,"esri/views/3d/layers/FeatureLikeLayerView3D":1697,"esri/layers/graphics/QueryEngine":1698,"esri/views/3d/layers/StreamLayerView3D":2255,"esri/views/layers/StreamLayerView":2256})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{1503:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(6),i(17),i(0)],void 0===(n=function(e,t,i,r,n,s,a){return function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r=e.call(this)||this;return r.handles=new s,r}return i(t,e),t.prototype.destroy=function(){this.handles.destroy()},r([a.property({readOnly:!0})],t.prototype,"handles",void 0),r([a.subclass("esri.core.HandleOwner")],t)}(a.declared(n))}.apply(null,r))||(e.exports=n)},1504:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(48),i(1503),i(210),i(10),i(209),i(9),i(0)],void 0===(n=function(e,t,i,r,n,s,a,o,l,p,h){return function(e){function t(t){var i=e.call(this)||this;return i.layer=null,i.parent=null,i.view=null,i}return i(t,e),t.prototype.initialize=function(){var e=this;this.addResolvingPromise(this.layer),this.when().catch(function(t){if("layerview:create-error"!==t.name){var i=e.layer&&e.layer.id||"no id",r=e.layer&&e.layer.title||"no title";return o.getLogger(e.declaredClass).error("#resolve()","Failed to resolve layer view (layer title: '"+r+"', id: '"+i+"')",t),p.reject(t)}})},t.prototype.destroy=function(){this.layer=this.view=this.parent=null},Object.defineProperty(t.prototype,"suspended",{get:function(){return!this.canResume()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return!this.suspended&&this.isUpdating()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return!0===this.get("layer.visible")},set:function(e){void 0!==e?this._override("visible",e):this._clearOverride("visible")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fullOpacity",{get:function(){var e=function(e){return null==e?1:e};return e(this.get("layer.opacity"))*e(this.get("parent.fullOpacity"))},enumerable:!0,configurable:!0}),t.prototype.canResume=function(){return!this.get("parent.suspended")&&this.get("view.ready")&&this.get("layer.loaded")&&this.visible||!1},t.prototype.isUpdating=function(){return!1},r([h.property()],t.prototype,"layer",void 0),r([h.property()],t.prototype,"parent",void 0),r([h.property({readOnly:!0,dependsOn:["view","visible","layer.loaded","parent.suspended"]})],t.prototype,"suspended",null),r([h.property({type:Boolean,dependsOn:["suspended"],readOnly:!0})],t.prototype,"updating",null),r([h.property()],t.prototype,"view",void 0),r([h.property({dependsOn:["layer.visible"]})],t.prototype,"visible",null),r([h.property({dependsOn:["layer.opacity","parent.fullOpacity"]})],t.prototype,"fullOpacity",null),r([h.subclass("esri.views.layers.LayerView")],t)}(h.declared(s,n,a.Identifiable,l))}.apply(null,r))||(e.exports=n)},1507:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(9),i(21),i(0),i(357),i(1504)],void 0===(n=function(e,t,i,r,n,s,a,o,l){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.slicePlaneEnabled=!1,t.supportsHeightUnitConversion=!1,t}return i(t,e),t.prototype.postscript=function(e){this.inherited(arguments),o.mayHaveHeightModelInfo(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())},t.prototype._validateHeightModelInfo=function(){var e=this;return n.create(function(t,i){s.whenFalseOnce(e.view.defaultsFromMap,"isHeightModelInfoSearching",function(){var r=o.rejectLayerError(e.layer,e.view.heightModelInfo,e.supportsHeightUnitConversion);r?i(r):t()})})},r([a.property()],t.prototype,"view",void 0),r([a.property()],t.prototype,"slicePlaneEnabled",void 0),r([a.subclass("esri.views.3d.layers.LayerView3D")],t)}(a.declared(l))}.apply(null,r))||(e.exports=n)},1534:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(9),i(44),i(366)],void 0===(n=function(e,t,i,r,n){Object.defineProperty(t,"__esModule",{value:!0}),t.toViewIfLocal=function(e){var t=e.view.spatialReference,s=e.layer.fullExtent,a=s&&s.spatialReference;return a?a.equals(t)?i.resolve(s.clone()):r.canProject(a,t)?i.resolve(r.project(s,t)):e.view.state.isLocal?n.projectGeometry(s,t,e.layer.portalItem).then(function(t){if(!e.destroyed&&t)return t}).catch(function(){return null}):i.resolve(null):i.resolve(null)}}.apply(null,r))||(e.exports=n)},1545:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.queryCapabilities={supportsStatistics:!0,supportsCentroid:!0,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0}}.apply(null,r))||(e.exports=n)},1551:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){return function(){function e(){this.items=[]}return e.prototype.addObject=function(e,t){this.items.push({type:"object",highlightId:t,object:e})},e.prototype.addRenderGeometry=function(e,t,i){this.items.push({type:"renderGeometry",highlightId:t,renderGeometry:e,owner:i})},e.prototype.addExternal=function(e,t){this.items.push({type:"external",highlightId:t,remove:e})},e.prototype.remove=function(e){for(var t=this.items.length-1;t>=0;--t){var i=this.items[t];i.highlightId===e&&(this.removeHighlight(i),this.items.splice(t,1))}},e.prototype.removeObject=function(e){for(var t=this.items.length-1;t>=0;--t){var i=this.items[t];"object"===i.type&&i.object===e&&(this.removeHighlight(i),this.items.splice(t,1))}},e.prototype.removeRenderGeometry=function(e){for(var t=this.items.length-1;t>=0;--t){var i=this.items[t];"renderGeometry"===i.type&&i.renderGeometry===e&&(this.removeHighlight(i),this.items.splice(t,1))}},e.prototype.removeAll=function(){var e=this;this.items.forEach(function(t){e.removeHighlight(t)}),this.items=[]},e.prototype.removeHighlight=function(e){switch(e.type){case"object":e.object.removeHighlights(e.highlightId);break;case"renderGeometry":e.owner.removeRenderGeometryHighlight(e.renderGeometry,e.highlightId);break;case"external":e.remove(e.highlightId)}},e}()}.apply(null,r))||(e.exports=n)},1558:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(88),i(1603)],void 0===(n=function(e,t,i,r){function n(e,t,i){if(!i)return t.indexOf(e);for(var r=0;r<t.length;r++)if(i(e,t[r]))return r;return-1}function s(e,t){a(e,0,e.children.length,t,e)}function a(e,t,i,r,n){n||(n=g(null,!0)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var s=t,a=void 0;s<i;s++)a=e.children[s],o(n,e.leaf?r(a):a);return n}function o(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function l(e,t){return e.minX-t.minX}function p(e,t){return e.minY-t.minY}function h(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function u(e){return e.maxX-e.minX+(e.maxY-e.minY)}function c(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function d(e,t){var i=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),n=Math.min(e.maxX,t.maxX),s=Math.min(e.maxY,t.maxY);return Math.max(0,n-i)*Math.max(0,s-r)}function y(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function f(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function g(e,t){return{children:e,height:1,leaf:t,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(e,t,i,n,s){for(var a=[t,i];a.length;)if(!((i=a.pop())-(t=a.pop())<=n)){var o=t+Math.ceil((i-t)/n/2)*n;r(e,o,t,i,s),a.push(t,o,o,i)}}Object.defineProperty(t,"__esModule",{value:!0});var b=function(){function e(e,t){void 0===e&&(e=9),this.compareMinX=l,this.compareMinY=p,this.toBBox=function(e){return e},this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&("function"==typeof t?this.toBBox=t:this._initFormat(t)),this.clear()}return e.prototype.destroy=function(){this.clear(),v.prune(),x.prune(),w.prune(),S.prune()},e.prototype.all=function(e){this._all(this.data,e)},e.prototype.search=function(e,t){var i=this.data,r=this.toBBox;if(f(e,i))for(v.clear();i;){for(var n=0,s=i.children.length;n<s;n++){var a=i.children[n],o=i.leaf?r(a):a;f(e,o)&&(i.leaf?t(a):y(e,o)?this._all(a,t):v.push(a))}i=v.pop()}},e.prototype.collides=function(e){var t=this.data,i=this.toBBox;if(!f(e,t))return!1;for(v.clear();t;){for(var r=0,n=t.children.length;r<n;r++){var s=t.children[r],a=t.leaf?i(s):s;if(f(e,a)){if(t.leaf||y(e,a))return!0;v.push(s)}}t=v.pop()}return!1},e.prototype.load=function(e,t){if(void 0===t&&(t=e.length),!t)return this;if(t<this._minEntries){for(var i=0,r=t;i<r;i++)this.insert(e[i]);return this}var n=this._build(e.slice(0,t),0,t-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var s=this.data;this.data=n,n=s}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},e.prototype.insert=function(e){return e&&this._insert(e,this.data.height-1),this},e.prototype.clear=function(){return this.data=g([],!0),this},e.prototype.remove=function(e,t){if(!e)return this;var i,r,s,a,o=this.data,l=this.toBBox(e);for(w.clear(),S.clear();o||w.length;){if(o||(o=w.pop(),i=w.data[w.length-1],r=S.pop(),s=!0),o.leaf&&-1!==(a=n(e,o.children,t)))return o.children.splice(a,1),w.push(o),this._condense(w),this;s||o.leaf||!y(o,l)?i?(r++,o=i.children[r],s=!1):o=null:(w.push(o),S.push(r),r=0,i=o,o=o.children[0])}return this},e.prototype.toJSON=function(){return this.data},e.prototype.fromJSON=function(e){return this.data=e,this},e.prototype._all=function(e,t){for(x.clear();e;){if(!0===e.leaf)for(var i=0,r=e.children;i<r.length;i++){t(r[i])}else x.pushArray(e.children);e=x.pop()}},e.prototype._build=function(e,t,i,r){var n,a=i-t+1,o=this._maxEntries;if(a<=o)return s(n=g(e.slice(t,i+1),!0),this.toBBox),n;r||(r=Math.ceil(Math.log(a)/Math.log(o)),o=Math.ceil(a/Math.pow(o,r-1))),(n=g([],!1)).height=r;var l=Math.ceil(a/o),p=l*Math.ceil(Math.sqrt(o));m(e,t,i,p,this.compareMinX);for(var h=t;h<=i;h+=p){var u=Math.min(h+p-1,i);m(e,h,u,l,this.compareMinY);for(var c=h;c<=u;c+=l){var d=Math.min(c+l-1,u);n.children.push(this._build(e,c,d,r-1))}}return s(n,this.toBBox),n},e.prototype._chooseSubtree=function(e,t,i,r){for(;r.push(t),!0!==t.leaf&&r.length-1!==i;){for(var n=1/0,s=1/0,a=void 0,o=0,l=t.children.length;o<l;o++){var p=t.children[o],u=h(p),d=c(e,p)-u;d<s?(s=d,n=u<n?u:n,a=p):d===s&&u<n&&(n=u,a=p)}t=a||t.children[0]}return t},e.prototype._insert=function(e,t,i){var r=this.toBBox,n=i?e:r(e);w.clear();var s=this._chooseSubtree(n,this.data,t,w);for(s.children.push(e),o(s,n);t>=0&&w.data[t].children.length>this._maxEntries;)this._split(w,t),t--;this._adjustParentBBoxes(n,w,t)},e.prototype._split=function(e,t){var i=e.data[t],r=i.children.length,n=this._minEntries;this._chooseSplitAxis(i,n,r);var a=this._chooseSplitIndex(i,n,r),o=g(i.children.splice(a,i.children.length-a),i.leaf);o.height=i.height,s(i,this.toBBox),s(o,this.toBBox),t?e.data[t-1].children.push(o):this._splitRoot(i,o)},e.prototype._splitRoot=function(e,t){this.data=g([e,t],!1),this.data.height=e.height+1,s(this.data,this.toBBox)},e.prototype._chooseSplitIndex=function(e,t,i){var r,n,s;r=n=1/0;for(var o=t;o<=i-t;o++){var l=a(e,0,o,this.toBBox),p=a(e,o,i,this.toBBox),u=d(l,p),c=h(l)+h(p);u<r?(r=u,s=o,n=c<n?c:n):u===r&&c<n&&(n=c,s=o)}return s},e.prototype._chooseSplitAxis=function(e,t,i){var r=e.leaf?this.compareMinX:l,n=e.leaf?this.compareMinY:p;this._allDistMargin(e,t,i,r)<this._allDistMargin(e,t,i,n)&&e.children.sort(r)},e.prototype._allDistMargin=function(e,t,i,r){e.children.sort(r);for(var n=this.toBBox,s=a(e,0,t,n),l=a(e,i-t,i,n),p=u(s)+u(l),h=t;h<i-t;h++){var c=e.children[h];o(s,e.leaf?n(c):c),p+=u(s)}for(h=i-t-1;h>=t;h--){c=e.children[h];o(l,e.leaf?n(c):c),p+=u(l)}return p},e.prototype._adjustParentBBoxes=function(e,t,i){for(var r=i;r>=0;r--)o(t.data[r],e)},e.prototype._condense=function(e){for(var t=e.length-1,i=void 0;t>=0;t--)0===e.data[t].children.length?t>0?(i=e.data[t-1].children).splice(i.indexOf(e.data[t]),1):this.clear():s(e.data[t],this.toBBox)},e.prototype._initFormat=function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")},e}();t.PooledRBush=b;var v=new i,x=new i,w=new i,S=new i({deallocator:null});t.default=b}.apply(null,r))||(e.exports=n)},1574:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(6),i(17),i(21),i(0),i(49),i(572)],void 0===(n=function(e,t,i,r,n,s,a,o,l,p){var h=-.3*l.earthRadius;return function(e){function t(){var t=e.call(this)||this;return t.suspended=!0,t._frustumVisibilityDirty=!0,t.extent=null,t.extentIntersectionDirty=!0,t._isVisibleBelowSurface=!1,t.handles=new s,t.layerView=null,t}return i(t,e),Object.defineProperty(t.prototype,"frustumVisibilityDirty",{get:function(){return this._frustumVisibilityDirty},set:function(e){e!==this._frustumVisibilityDirty&&(this._frustumVisibilityDirty=e,this.notifyChange("updating"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return this.frustumVisibilityDirty},enumerable:!0,configurable:!0}),t.prototype.setup=function(e){var t=this;this.layerView=e,this.extentIntersection=new p.FrustumExtentIntersection({renderCoordsHelper:e.view.renderCoordsHelper});var i=e.view,r=i.basemapTerrain,n=i.resourceController.scheduler;this.handles.add([i.on("resize",function(){return t.viewChange()}),i.state.watch("camera",function(){return t.viewChange()},!0),n.registerTask(6,function(){return t.update()},function(){return t.needsUpdate()}),r.on("elevation-bounds-change",function(){return t.elevationBoundsChange()})]),"local"===i.viewingMode?this.isVisibleBelowSurface=!0:this.handles.add(a.init(r,["opacity","wireframe"],function(){return t.isVisibleBelowSurface=!r.isOpaque()}))},t.prototype.destroy=function(){this.layerView=null,this.extent=null,this.extentIntersection=null,this.handles&&(this.handles.destroy(),this.handles=null)},t.prototype.setExtent=function(e){this.extent=e,this.extentIntersectionDirty=!0,this.frustumVisibilityDirty=!0},t.prototype.viewChange=function(){this.frustumVisibilityDirty=!0},t.prototype.elevationBoundsChange=function(){this.frustumVisibilityDirty=!0,this.extentIntersectionDirty=!0},Object.defineProperty(t.prototype,"isVisibleBelowSurface",{set:function(e){this._isVisibleBelowSurface=e,this.frustumVisibilityDirty=!0,this.extentIntersectionDirty=!0},enumerable:!0,configurable:!0}),t.prototype.needsUpdate=function(){return this.frustumVisibilityDirty},t.prototype.update=function(){this.updateSuspendFrustumVisible(),this.frustumVisibilityDirty=!1},t.prototype.updateExtentIntersection=function(){if(this.extentIntersectionDirty){this.extentIntersectionDirty=!1;var e,t=this.layerView.view;if(this._isVisibleBelowSurface)e=h;else{var i=t.basemapTerrain.getElevationBounds(),r=i[0],n=i[1];e=r-Math.max(1,(n-r)*(1.2-1))}this.extentIntersection.update(this.extent,t.spatialReference,e)}},t.prototype.updateSuspendFrustumVisible=function(){if(this.extent){this.updateExtentIntersection();var e=this.layerView.view.frustum;this._set("suspended",!this.extentIntersection.isVisibleInFrustum(e))}else this._set("suspended",!1)},r([o.property({readOnly:!0})],t.prototype,"suspended",void 0),r([o.property({readOnly:!0})],t.prototype,"updating",null),r([o.subclass("esri.views.3d.layers.graphics.Graphics3DFrustumVisibility")],t)}(o.declared(n))}.apply(null,r))||(e.exports=n)},1575:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.defaultIconElevationOffset=1,t.SUSPEND_RESUME_EXTENT_OPTIMISM=1.2}.apply(null,r))||(e.exports=n)},1576:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(22),i(25),i(43),i(359),i(62),i(6),i(52),i(23),i(13),i(17),i(179),i(10),i(92),i(32),i(132),i(80),i(88),i(9),i(21),i(0),i(3),i(45),i(37),i(126),i(128),i(555),i(1577),i(81),i(560),i(573),i(178),i(570),i(1578),i(1579),i(571),i(72),i(181),i(51),i(137),i(85),i(375),i(368)],void 0===(n=function(e,t,i,r,n,s,a,o,l,p,h,u,c,d,y,f,g,m,b,v,x,w,S,C,_,E,G,V,D,R,I,O,P,j,F,U,M,q,A,L,B,T,z,H,k,X){var Y=new a.Point,Q=_.vec3f64.create(),W=E.create(),N=f.getLogger("esri.views.3d.layers.graphics.Graphics3DCore"),J=function(e){function t(t){var i=e.call(this)||this;return i.propertiesPool=new z.PropertiesPool({computedExtent:a.Extent},i),i.computedExtent=null,i.currentRenderer=null,i.rendererHasGeometryOperations=!1,i.symbolCreationContext=new M.Graphics3DSymbolCreationContext,i.graphics=new Map,i.stageLayer=null,i.stage=null,i.graphicsDrapedUids=new Set,i.graphicsBySymbol=new Map,i.symbolConversionCache=new Map,i.symbols=new Map,i.graphicsWithoutSymbol={},i.graphicsWaitingForSymbol=new Set,i.lastFastUpdate=null,i.handles=new d,i.viewSR=null,i.elevationAlignment=null,i.scaleVisibility=null,i.filterVisibility=null,i.spatialIndex=null,i.deconfliction=null,i.labeling=null,i.highlights=null,i.viewElevationProvider=null,i.sharedSymbolResourcesOwnerHandle=null,i.whenGraphics3DGraphicRequests={},i.pendingUpdates=new Map,i.pendingAdds=0,i.pendingRemoves=0,i.pendingUpdatesPool=new x({allocator:function(e){return e||{add:null,remove:null}},deallocator:function(e){return e.add=null,e.remove=null,e}}),i.symbolWarningLogged=!1,i.geometryWarningLogged=!1,i.objectIdInvisibleSet=new Set,i._whenSymbolRemoved=new x,i.asyncUpdates=!1,i.elevationFeatureExpressionEnabled=!0,i.owner=null,i.layer=null,i.hasDraped=!1,i.graphicSymbolSupported=!0,i._usedMemory=0,i.numberOfGraphics=0,i._visible=void 0,i._startCreateGraphics=!1,i.maxPendingUpdates=0,i}var p;return i(t,e),p=t,Object.defineProperty(t.prototype,"updating",{get:function(){return!!(this.graphicsWaitingForSymbol.size>0||this.needsUpdate()||this.elevationAlignment&&this.elevationAlignment.updating||this.scaleVisibility&&this.scaleVisibility.updating||this.filterVisibility&&this.filterVisibility.updating)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updatingRemaining",{get:function(){return this.updating?this.pendingUpdates.size:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updatingTotal",{get:function(){return this.updating?this.maxPendingUpdates:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayFeatureLimit",{get:function(){var e=this.owner&&this.owner.view&&this.owner.view.qualitySettings,t=e?e.graphics3D.minTotalNumberOfFeatures:0,i=e?e.graphics3D.maxTotalNumberOfFeatures:0,r=e?e.graphics3D.maxTotalNumberOfPrimitives:0,n=this.maxSymbolComplexity,s=Math.max(t,Math.min(i,Math.ceil(r/Math.max(1,n?n.primitivesPerFeature:1)))),a=this._get("displayFeatureLimit");return a&&a.minimumTotalNumberOfFeatures===t&&a.maximumTotalNumberOfFeatures===i&&a.maximumTotalNumberOfPrimitives===r&&a.maximumSymbolComplexity===n&&a.maximumNumberOfFeatures===s?a:{minimumTotalNumberOfFeatures:t,maximumTotalNumberOfFeatures:i,maximumTotalNumberOfPrimitives:r,maximumSymbolComplexity:n,maximumNumberOfFeatures:s}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxSymbolComplexity",{get:function(){for(var e=null,t=0,i=this.getSymbolComplexities();t<i.length;t++){var r=i[t];e?0===e.primitivesPerCoordinate&&r.primitivesPerFeature>e.primitivesPerFeature?e=r:0!==e.primitivesPerCoordinate&&r.primitivesPerCoordinate>e.primitivesPerCoordinate&&(e=r):e=r}var n=this._get("maxSymbolComplexity");return!e||n&&n.primitivesPerFeature===e.primitivesPerFeature&&n.primitivesPerCoordinate===e.primitivesPerCoordinate?n:e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"usedMemory",{get:function(){return this._usedMemory},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"usedMemoryPerGraphic",{get:function(){return this._usedMemory&&this.numberOfGraphics?this._usedMemory/this.numberOfGraphics:this.maxSymbolComplexity?this.maxSymbolComplexity.memory.bytesPerFeature:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"unprocessedMemoryEstimate",{get:function(){return Math.max(0,(this.pendingAdds-this.pendingRemoves)*this.usedMemoryPerGraphic)},enumerable:!0,configurable:!0}),t.prototype.getSymbolComplexities=function(){return this.currentRenderer?this.getSymbolComplexitiesUsedOrRenderer(this.currentRenderer):this.getSymbolComplexitiesUsed()},t.prototype.getConvertedSymbol=function(e){if("web-style"===e.type)return e.clone();var t=this.symbolConversionCache.get(e.id);if(void 0!==t)return t;var i=P.to3D(e,!0,!1,this.hasLabelingContext(e)),r=i.symbol||null;return r||i.error&&N.error(i.error.message),this.symbolConversionCache.set(e.id,r),r},t.prototype.getSymbolComplexitiesUsedOrRenderer=function(e){var t=e.getSymbols();if(!t||!t.length)return[];for(var i=[],r=0,n=t;r<n.length;r++){var s=n[r],a=this.symbols.get(s.id);if(a)i.push(a.complexity);else{var o=this.getConvertedSymbol(s);o&&i.push(B.defaultSymbolComplexity(o))}}return i},t.prototype.getSymbolComplexitiesUsed=function(){var e=[];return this.symbols.forEach(function(t){t&&e.push(t.complexity)}),e},t.prototype.initialize=function(){this.viewSR=this.owner.view.spatialReference},t.prototype.setup=function(e){var t=this;this._set("elevationAlignment",e.elevationAlignment),this._set("scaleVisibility",e.scaleVisibility),this._set("filterVisibility",e.filterVisibility),this._set("spatialIndex",e.spatialIndex),this._set("deconfliction",e.deconfliction),this._set("labeling",e.labeling),this._set("highlights",e.highlights);var i=this.owner.view;this.viewElevationProvider=new j.ViewElevationProvider(this.viewSR,i),this.initializeStage(i,this.layer.uid),this.symbolCreationContext.sharedResources=i.sharedSymbolResources,this.sharedSymbolResourcesOwnerHandle=i.sharedSymbolResources.addGraphicsOwner(this.owner),this.symbolCreationContext.renderer=this.currentRenderer,this.symbolCreationContext.stage=this.stage,this.symbolCreationContext.streamDataSupplier=i.sharedSymbolResources.streamDataSupplier,this.symbolCreationContext.renderSpatialReference=i.renderSpatialReference,this.symbolCreationContext.renderCoordsHelper=i.renderCoordsHelper,this.symbolCreationContext.layer=this.layer,this.symbolCreationContext.layerView=this.owner,this.symbolCreationContext.layerOrder=0,this.symbolCreationContext.localOriginFactory=new k,this.symbolCreationContext.elevationProvider=i.elevationProvider,this.symbolCreationContext.isAsync=this.asyncUpdates;var r=F.extractExpressionInfo(this.layer.elevationInfo,this.elevationFeatureExpressionEnabled);this.symbolCreationContext.featureExpressionInfoContext=F.createContext(r,this.viewSR,N),this.symbolCreationContext.screenSizePerspectiveEnabled=i.screenSizePerspectiveEnabled&&this.layer.screenSizePerspectiveEnabled,this.symbolCreationContext.slicePlaneEnabled=!!this.owner.slicePlaneEnabled,this.handles.add(this.owner.watch("suspended",function(){return t.updateLayerVisibility()}));var n="layer"in this.owner?["layer.screenSizePerspectiveEnabled,view.screenSizePerspectiveEnabled"]:"view.screenSizePerspectiveEnabled";this.handles.add([this.owner.watch(n,function(){var e=i.screenSizePerspectiveEnabled&&t.layer.screenSizePerspectiveEnabled;e!==t.symbolCreationContext.screenSizePerspectiveEnabled&&(t.symbolCreationContext.screenSizePerspectiveEnabled=e,t.recreateAllGraphics())}),this.owner.watch("slicePlaneEnabled",function(e){return t.slicePlaneEnabledChange(!!e)}),this.owner.view.watch("pixelRatio",function(e){return t.pixelRatioChange(e)}),S.when(i.basemapTerrain,"tilingScheme",function(e){e.spatialReference.equals(t.symbolCreationContext.overlaySR)||(t.symbolCreationContext.overlaySR=i.basemapTerrain.spatialReference),t.handles.has("loaded-graphics")?t.recreateAllGraphics():t.handles.add(S.on(t.owner,"loadedGraphics","change",function(e){return t.graphicsCollectionChanged(e)},function(){return t.recreateAllGraphics()}),"loaded-graphics")}),i.resourceController.scheduler.registerTask(3,function(e){return t.update(e)},function(){return t.needsUpdate()})]),this.owner.layer&&"featureReduction"in this.owner.layer&&this.handles.add(this.owner.watch("layer.featureReduction",function(){return t.deconfliction.featureReductionChange()})),this.rendererChange(this.layer.renderer),this.notifyChange("maxSymbolComplexity")},t.prototype.destroy=function(){for(var e in this.owner.view.deconflictor.removeGraphicsOwner(this),this.owner.view.labeler.removeGraphicsOwner(this),this.clear(),this.stage&&(this.stage.removeFromViewContent([this.stageLayer.id]),this.stage.remove(H.ModelContentType.LAYER,this.stageLayer.id),this.stageLayer=null,this.stage=null),this.handles.destroy(),this.handles=null,this.viewSR=null,this._set("owner",null),this.whenGraphics3DGraphicRequests)this.whenGraphics3DGraphicRequests[e].reject(new c("graphic:layer-destroyed","Layer has been destroyed"));this.whenGraphics3DGraphicRequests=null,this.sharedSymbolResourcesOwnerHandle&&(this.sharedSymbolResourcesOwnerHandle.remove(),this.sharedSymbolResourcesOwnerHandle=null),this.propertiesPool&&(this.propertiesPool.destroy(),this.propertiesPool=null),this.pendingUpdatesPool=null,this.symbolConversionCache.clear(),this.objectIdInvisibleSet.clear()},t.prototype.clear=function(){this.graphics.forEach(function(e){return e.destroy()}),this.spatialIndex&&this.spatialIndex.clear(),this.graphics.clear(),this.numberOfGraphics=0,this._usedMemory=0,this.updateLayerVisibility(),this.symbols.forEach(function(e){e&&e.destroy()}),this.symbols.clear(),this.graphicsBySymbol.clear(),this.graphicsWithoutSymbol={},this.graphicsWaitingForSymbol.clear(),this.pendingUpdates.clear(),this.pendingUpdatesPool.clear(),this.maxPendingUpdates=0,this.pendingAdds=0,this.pendingRemoves=0,this._set("hasDraped",!1),this.notifyChange("updating"),this.notifyChange("updatingTotal"),this.notifyChange("updatingRemaining")},t.prototype.initializeStage=function(e,t){this.stage=e._stage,this.stageLayer=new X(t,{isPickable:!this.owner.suspended},t),this.stage.add(H.ModelContentType.LAYER,this.stageLayer),this.stage.addToViewContent([this.stageLayer.id])},t.prototype.setDrawingOrder=function(e){this.symbolCreationContext.layerOrder=e;var t=new Set;this.symbols.forEach(function(i){i&&i.setDrawOrder(e,t)}),t.size>0&&this.stage.getDrapedRenderer().updateRenderOrder(t)},t.prototype.updateLayerVisibility=function(){var e=!!this.owner.suspended,t=this.numberOfGraphics>this.displayFeatureLimit.maximumNumberOfFeatures*ee,i=!e&&!t;i!==this._visible&&(this._visible=i,i?(this.stageLayer.isPickable=!0,this.updateAllGraphicsVisibility()):(this.stageLayer.isPickable=!1,this.hideAllGraphics()),this.updateStageLayerVisibility())},t.prototype.updateStageLayerVisibility=function(){this.stageLayer.isVisible=this._visible&&(null==this.layer.opacity||this.layer.opacity>0)},Object.defineProperty(t.prototype,"graphics3DGraphics",{get:function(){return this.graphics},enumerable:!0,configurable:!0}),t.prototype.getGraphics3DGraphicById=function(e){return this.graphics.get(e)},t.prototype._getGraphicObjectID=function(e,t){return void 0===t&&(t=this.owner.layer&&this.owner.layer.objectIdField),null!=e.objectId?e.objectId:t&&e.attributes[t]},Object.defineProperty(t.prototype,"graphics3DGraphicsByObjectID",{get:function(){var e=this,t=this.owner.layer&&this.owner.layer.objectIdField;if(!t)return null;var i=new Map;return this.graphics.forEach(function(r){if(r){var n=r.graphic,s=e._getGraphicObjectID(n,t);m.isSome(s)&&i.set(s,r)}}),i},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelsEnabled",{get:function(){return!(!this.labeling||!this.labeling.layerLabelsEnabled())},enumerable:!0,configurable:!0}),t.prototype.updateLabelingInfo=function(e){var t=this.deconfliction&&this.deconfliction.labelingInfoChange(e),i=this.labeling&&this.labeling.labelingInfoChange(e);return w.all([t,i]).then()},t.prototype.updateVisibilityInfo=function(){this.deconfliction&&this.deconfliction.labelingInfoChange(),this.labeling&&this.labeling.visibilityInfoChange()},Object.defineProperty(t.prototype,"symbolUpdateType",{get:function(){var e=this;if(this.pendingUpdates.size>0)return"unknown";var t=0,i=0;return y.everyMap(this.symbols,function(r,n){if(r){var s=r.getFastUpdateStatus();if(s.loading>0)return!1;e.graphicsBySymbol.has(n)&&(i+=s.fast,t+=s.slow)}})?i>=0&&0===t?"fast":t>=0&&0===i?"slow":"mixed":"unknown"},enumerable:!0,configurable:!0}),t.prototype.needsUpdate=function(){return this.pendingUpdates.size>0||!!this.lastFastUpdate&&b()-this.lastFastUpdate>500},t.prototype.update=function(e){var t=this.needsUpdate();this._applyPendingUpdates(e),!e.done&&this.lastFastUpdate&&(this.lastFastUpdate=null),t!==this.needsUpdate()&&this.notifyChange("updating")},t.prototype.setObjectIdVisibility=function(e,t){t?this.objectIdInvisibleSet.delete(e):this.objectIdInvisibleSet.add(e);var i=this._findGraphics3DGraphicByObjectId(e);m.isSome(i)&&this._updateUserVisibility(i)},t.prototype._findGraphics3DGraphicByObjectId=function(e){var t,i=this;return y.everyMap(this.graphics,function(r){return i._getGraphicObjectID(r.graphic)!==e||(t=r,!1)}),t},t.prototype._updateUserVisibility=function(e){if(m.isNone(e))return!1;var t=e.graphic,i=this._getGraphicObjectID(t),r=t.visible&&!this.owner.suspended&&(m.isNone(i)||!this.objectIdInvisibleSet.has(i));return e.setVisibilityFlag(0,r,0)},t.prototype.whenGraphics3DGraphic=function(e){var t=this.graphics.get(e.uid);if(t)return w.resolve(t);var i=this.whenGraphics3DGraphicRequests[e.uid];if(i)return i.promise;var r=w.createDeferred();return this.whenGraphics3DGraphicRequests[e.uid]=r,r.promise},t.prototype.boundsForGraphics3DGraphic=function(e,t){return s(this,void 0,void 0,function(){var i,r,s,a,o,l,p,h,u,c;return n(this,function(n){switch(n.label){case 0:return i=this.owner.view.spatialReference,r=this.owner.view.renderSpatialReference,s=this.owner.view.basemapTerrain.spatialReference,a=function(e,t,n){return T.bufferToBuffer(e,r,t,e,i,t,n)},o=function(e,t,r){return T.bufferToBuffer(e,s,t,e,i,t,r)},l=this.viewElevationProvider?{service:this.viewElevationProvider,useViewElevation:t&&t.useViewElevation,minDemResolution:t&&t.minDemResolution,minDemResolutionForPoints:this.owner.view.resolution}:null,[4,e.getProjectedBoundingBox(a,o,l)];case 1:return(p=n.sent())?(h=p.boundingBox,p.requiresDrapedElevation&&(u=this.symbolCreationContext.elevationProvider)&&(E.center(h,Q),Y.x=Q[0],Y.y=Q[1],Y.z=void 0,Y.spatialReference=i,c=u.getElevation(Y)||0,h[2]=Math.min(h[2],c),h[5]=Math.max(h[5],c)),[2,{boundingBox:h,screenSpaceObjects:p.screenSpaceObjects}]):[2,null]}})})},t.prototype.whenGraphicBounds=function(e,t){var i=this;return S.whenOnce(this.owner,"loadedGraphics").then(function(){var t=i.owner.layer&&i.owner.layer.objectIdField,r=i.owner.loadedGraphics.find(function(i){return i===e||t&&i.attributes&&e.attributes&&i.attributes[t]===e.attributes[t]});if(r)return i.whenGraphics3DGraphic(r);throw new c("internal:graphic-not-part-of-view","Graphic is not part of this view")}).then(function(e){return i.boundsForGraphics3DGraphic(e,t)})},t.prototype.whenSymbolLayerSize=function(e,t){return s(this,void 0,void 0,function(){var i,r,s;return n(this,function(n){if(null==(i=this.symbols.get(e.id)))throw new c("internal:symbol-not-part-of-view","Symbol is not part of this view");if(-1===(r=e.symbolLayers.indexOf(t)))throw new c("internal:missing-symbol-layer","Symbol layer is not in symbol");return s=w.createResolver(),i.getSymbolLayerSize(r,function(e){null==e?s.reject(new c("internal:missing-size","Symbol layer has no valid size")):s(e)}),[2,s.promise]})})},t.prototype.graphicsCollectionChanged=function(e){this._startCreateGraphics&&(this.add(e.added),this.remove(e.removed))},t.prototype.graphicUpdateHandler=function(e){var t=e.graphic.uid,i=this.graphics.get(t),r=this.graphicsWithoutSymbol[t];if(i||r)switch(e.property){case"visible":this.graphicUpdateVisibleHandler(i,e);break;case"geometry":this.graphicUpdateGeometryHandler(i,e);break;case"symbol":this.graphicUpdateSymbolHandler(i,e);break;case"attributes":break;default:u.neverReached(e)}},t.prototype.graphicUpdateGeometryHandler=function(e,t){var i=t.graphic.geometry;if(i)if(m.isNone(e)){var r=t.graphic.symbol&&t.graphic.symbol.id;if(r){var n=this.symbols.get(r);if(n&&!n.isFulfilled())return}this.recreateGraphic(t.graphic)}else e.graphics3DSymbol.updateGeometry(e,t.newValue)||this.recreateGraphic(e.graphic),this.expandComputedExtent(i);else this.recreateGraphic(t.graphic)},t.prototype.graphicUpdateSymbolHandler=function(e,t){var i=t.graphic,r=m.isSome(e)?e.graphics3DSymbol:t.oldValue&&this.symbols.get(t.oldValue.id);if(r){var n=r.symbol,s=this.getConvertedSymbol(t.newValue);if(s.type===n.type&&"web-style"!==s.type&&"web-style"!==n.type){var a=this.graphicsBySymbol.get(n.id);if(a&&1!==a.size)this.recreateGraphic(i);else{var o=R.diff(n,s);if(m.isNone(o))this.updateSymbolMapping(n.id,s);else{var l={diff:o,graphics3DGraphicPatches:[],symbolStatePatches:[]};if(r.prepareSymbolPatch(l),R.isEmpty(l.diff)){for(var p=0,h=l.symbolStatePatches;p<h.length;p++){(0,h[p])()}var u=this._getRenderingInfo(i);if(m.isSome(e))for(var c=0,d=l.graphics3DGraphicPatches;c<d.length;c++){(0,d[c])(e,u)}this.updateSymbolMapping(n.id,s)}else this.recreateGraphic(i)}}}else this.recreateGraphic(i)}else this.recreateGraphic(i)},t.prototype.graphicUpdateVisibleHandler=function(e,t){var i=this._updateUserVisibility(e);i&&this.labeling&&(this.lastFastUpdate=b(),this.owner.view.labeler.setDirty()),i&&this.owner.view.deconflictor.setDirty()},t.prototype.recreateGraphic=function(e){var t=[e];this.remove(t),this.add(t)},t.prototype._beginGraphicUpdate=function(e){this.graphicsWaitingForSymbol.add(e.uid),1===this.graphicsWaitingForSymbol.size&&this.notifyChange("updating"),this._get("symbolsUpdating")||this._set("symbolsUpdating",!0)},t.prototype._endGraphicUpdate=function(e){e&&(this.graphicsWaitingForSymbol.delete(e.uid),0===this.graphicsWaitingForSymbol.size&&(this._cleanupSymbols(),this.notifyChange("updating"),this._get("symbolsUpdating")&&(this.owner.view.flushDisplayModifications(),this._set("symbolsUpdating",!1))))},t.prototype.expandComputedExtent=function(e){var t=W,i=e.spatialReference;D.computeAABB(e,t);var r=this.viewSR,n=p.tmpVec;if(i.equals(r)||T.xyzToVector(t[0],t[1],0,i,n,r)&&(t[0]=n[0],t[1]=n[1],T.xyzToVector(t[3],t[4],0,i,n,r),t[3]=n[0],t[4]=n[1]),g.isFinite(t[0])&&g.isFinite(t[3])&&g.isFinite(t[1])&&g.isFinite(t[4])){var s=this.computedExtent,a=null,o=g.isFinite(t[2])&&g.isFinite(t[5]),l=o&&(!s||null==s.zmin||t[2]<s.zmin),h=o&&(!s||null==s.zmax||t[5]>s.zmax);s?(t[0]<s.xmin||t[1]<s.ymin||t[3]>s.xmax||t[4]>s.ymax||l||h)&&((a=this.propertiesPool.get("computedExtent")).xmin=Math.min(t[0],s.xmin),a.ymin=Math.min(t[1],s.ymin),a.xmax=Math.max(t[3],s.xmax),a.ymax=Math.max(t[4],s.ymax),a.spatialReference=r):((a=this.propertiesPool.get("computedExtent")).xmin=t[0],a.ymin=t[1],a.xmax=t[3],a.ymax=t[4],a.spatialReference=r),a&&(l&&(a.zmin=t[2]),h&&(a.zmax=t[5]),this._set("computedExtent",a))}},t.prototype.updateHasDraped=function(){var e=this.graphicsDrapedUids.size>0;this._set("hasDraped",e)},t.prototype.elevationInfoChange=function(){var e=this,t=F.extractExpressionInfo(this.layer.elevationInfo,this.elevationFeatureExpressionEnabled);this.symbolCreationContext.featureExpressionInfoContext=F.createContext(t,this.viewSR,N),this.labeling&&this.labeling.elevationInfoChange(),this.forEachGraphics3DSymbol(function(t,i,r){t.globalPropertyChanged("elevationInfo",i)?i.forEach(function(e){for(var t=e.graphic,i=e._labelGraphics,r=0;r<i.length;r++){var n=i[r];n.graphics3DSymbolLayer.updateGraphicElevationContext(t,n)}}):e._recreateSymbol(r)}),this.elevationAlignment&&this.elevationAlignment.elevationInfoChange()},t.prototype.clearSymbolsAndGraphics=function(){this.clear(),this.filterVisibility&&this.filterVisibility.clear(),this.labeling&&this.labeling.reset(),this.deconfliction&&this.deconfliction.clear(),this.elevationAlignment&&this.elevationAlignment.clear(),this.stageLayer&&this.stageLayer.invalidateSpatialQueryAccelerator()},t.prototype.startCreateGraphics=function(){this._startCreateGraphics=!0,this.recreateAllGraphics()},t.prototype.recreateAllGraphics=function(){this._startCreateGraphics&&(this.clearSymbolsAndGraphics(),this._set("computedExtent",null),this.symbolCreationContext.screenSizePerspectiveEnabled=this.owner.view.screenSizePerspectiveEnabled&&this.layer.screenSizePerspectiveEnabled,this.symbolCreationContext.slicePlaneEnabled=!!this.owner.slicePlaneEnabled,this.owner.loadedGraphics&&this.owner.loadedGraphics.length&&this.owner.view.basemapTerrain.tilingScheme&&this.add(this.owner.loadedGraphics.toArray()))},t.prototype._recreateSymbol=function(e){var t=this,i=[];this.graphicsBySymbol.get(e).forEach(function(e,r){var n=e.usedMemory;t._conditionalRemove(e,r),t.spatialIndex&&t.spatialIndex.remove(e),i.push(e.graphic),e.destroy(),t.removeGraphics3DGraphic(r,n),t.updateLayerVisibility()}),this.graphicsBySymbol.set(e,new Map);var r=this.symbols.get(e);r&&r.destroy(),this.symbols.delete(e),this.updateHasDraped(),this.add(i)},t.prototype._conditionalRemove=function(e,t){e.isDraped()&&this.graphicsDrapedUids.delete(t),this.highlights&&this.highlights.removeGraphic(e),this.labeling&&this.labeling.removeGraphic(e),this.deconfliction&&this.deconfliction.removeGraphic(e)},t.prototype.add=function(e){if(e&&0!==e.length){if(!this.owner.view.basemapTerrain||!this.owner.view.basemapTerrain.tilingScheme)return void N.error("#add()","Cannot add graphics before terrain surface has been initialized");this.asyncUpdates?this._addDelayed(e):this._addImmediate(e),this.notifyChange("updating")}},t.prototype._addImmediate=function(e){var t=this;this.geometryWarningLogged=!1,this.symbolWarningLogged=!1,Z.clear();for(var i=0,r=e;i<r.length;i++){var n=r[i];this._startAddGraphic(n,Z)}Z.forEach(function(e){return t._finishAddGraphics(e)}),Z.clear(),this.updateHasDraped(),this._cleanupSymbols(),this.owner.view.labeler.setDirty(),this._cleanupSymbols()},t.prototype._addDelayed=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t],n=r.uid,s=this.pendingUpdates.get(n);if(s)s.add||this.pendingAdds++,s.add=r;else{var a=this.pendingUpdatesPool.pushNew();a.add=r,this.pendingAdds++,this.pendingUpdates.set(n,a)}}this.maxPendingUpdates=Math.max(this.maxPendingUpdates,this.pendingUpdates.size),this.notifyChange("updatingTotal"),this.notifyChange("updatingRemaining")},t.prototype.remove=function(e){this.asyncUpdates?this._removeDelayed(e):this._removeImmediate(e),this.notifyChange("updating")},t.prototype._removeImmediate=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];this._removeGraphic(r)}this.updateHasDraped(),this._cleanupSymbols(),this.owner.view.labeler.setDirty()},t.prototype._removeDelayed=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t],n=r.uid,s=this.pendingUpdates.get(n);if(s)s.add&&(s.remove?s.add=null:this.pendingUpdates.delete(n),this.pendingAdds--);else{var a=this.pendingUpdatesPool.pushNew();a.remove=r,this.pendingUpdates.set(n,a),this.pendingRemoves++}}0===this.pendingUpdates.size&&this._finishPendingUpdates(),this.maxPendingUpdates=Math.max(this.maxPendingUpdates,this.pendingUpdates.size),this.notifyChange("updatingTotal"),this.notifyChange("updatingRemaining")},t.prototype._finishPendingUpdates=function(){this.pendingUpdatesPool.clear(),this.maxPendingUpdates=0,this._cleanupSymbols(),(this.pendingAdds||this.pendingRemoves)&&N.warn("pendingAdds/Removes in inconsistent state!"),this.pendingAdds=0,this.pendingRemoves=0},t.prototype._applyPendingUpdates=function(e){var t=this;this.geometryWarningLogged=!1,this.symbolWarningLogged=!1;var i=e.idleFrame?1e3:100,r=0;Z.clear(),y.everyMap(this.pendingUpdates,function(n,s){if(n.remove&&(t.pendingRemoves--,t._removeGraphic(n.remove)),n.add&&(t.pendingAdds--,t._startAddGraphic(n.add,Z)&&r++),t.pendingUpdates.delete(s),r>i&&(Z.forEach(function(e){return t._finishAddGraphics(e)}),Z.clear(),r=0),e.madeProgress(),e.done)return!1}),Z.forEach(function(e){return t._finishAddGraphics(e)}),Z.clear(),0===this.pendingUpdates.size&&this._finishPendingUpdates(),this.notifyChange("updatingTotal"),this.notifyChange("updatingRemaining"),this.updateHasDraped()},t.prototype._startAddGraphic=function(e,t){this.graphicsWithoutSymbol[e.uid]=e;var i=this._getRenderingInfo(e,N);if(!i)return!1;var r=i.symbol,n=this.getOrCreateGraphics3DSymbol(r,i.renderer);if(!n)return!1;this.expandComputedExtent(e.geometry),this._beginGraphicUpdate(e);var s={graphic:e,renderingInfo:i,layer:this.layer},a=n.symbol.id,o=t.get(a);if(o)o.graphics.push(s);else{var l=$.acquire();l.clear(),l.push(s),t.set(a,{asyncSymbol:n,graphics:l})}return!0},t.prototype._finishAddGraphics=function(e){var t=this,i=!1,r=function(t){t===e.asyncSymbol.symbol.id&&(i=!0)};this._whenSymbolRemoved.push(r),e.asyncSymbol.then(function(){t._whenSymbolRemoved.removeUnordered(r),K.clear();for(var n=0;n<e.graphics.length;n++){var s=e.graphics.data[n],a=s.graphic;if(!(i||e.asyncSymbol.destroyed||t.graphicSymbolSupported&&a.symbol&&a.symbol.id!==e.asyncSymbol.symbol.id)){if(t.graphicsWaitingForSymbol.has(a.uid)){var o=t.createGraphics3DGraphic(e.asyncSymbol,s);t.spatialIndex&&o&&K.push(o)}t._endGraphicUpdate(a)}--e.asyncSymbol.referenced}K.length>0&&(t.spatialIndex.addMany(K.data,K.length),K.clear()),e.graphics.clear(),$.release(e.graphics),t.labeling&&(t.lastFastUpdate=b(),t.owner.view.labeler.setDirty())},function(){if(t._whenSymbolRemoved.removeUnordered(r),!i&&!e.asyncSymbol.destroyed)for(var n=0;n<e.graphics.length;n++)t._endGraphicUpdate(e.graphics.data[n].graphic);e.graphics.clear(),$.release(e.graphics)})},t.prototype._removeGraphic=function(e){var t=e.uid,i=this.graphics.get(t);if(i){var r=i.usedMemory;this._conditionalRemove(i,t),this.spatialIndex&&this.spatialIndex.remove(i);var n=i.graphics3DSymbol.symbol.id;this.graphicsBySymbol.get(n).delete(t),delete this.graphicsWithoutSymbol[t],this.removeGraphics3DGraphic(t,r),i.destroy()}else delete this.graphicsWithoutSymbol[t],this.graphicsWaitingForSymbol.delete(t)},t.prototype.hasLabelingContext=function(e){if(e instanceof l.LabelSymbol3D||e instanceof l.TextSymbol){var t=this.symbolCreationContext.layer;return!!t.labelingInfo&&t.labelingInfo.some(function(t){return t.symbol===e})}return!1},t.prototype.hasValidSymbolCreationContext=function(e){return!(e instanceof l.LabelSymbol3D&&!this.hasLabelingContext(e)&&(N.error("LabelSymbol3D is only valid as part of a LabelClass. Using LabelSymbol3D as a renderer symbol is not supported."),1))},t.prototype._getRenderingInfo=function(e,t){if(!e.geometry)return t&&!this.geometryWarningLogged&&(this.geometryWarningLogged=!0,t.warn("Graphic in layer "+this.layer.id+" has no geometry and will not render")),null;if(!this.graphicSymbolSupported&&e.symbol)return t&&!this.symbolWarningLogged&&(this.symbolWarningLogged=!0,t.warn("Graphic in layer "+this.layer.id+" is not allowed to have a symbol, use a renderer instead")),null;var i=this.rendererHasGeometryOperations?D.hydrateGraphic(e,this.layer):e,r=this.owner.getRenderingInfo(i,this.currentRenderer);return r&&r.symbol?r:(t&&!this.symbolWarningLogged&&(this.symbolWarningLogged=!0,t.warn("Graphic in layer "+this.layer.id+" has no symbol and will not render")),null)},t.prototype.createGraphics3DSymbol=function(e,t){var i=this;if(!this.hasValidSymbolCreationContext(e))return null;var r,n=this.getConvertedSymbol(e);if(!n)return null;if(t&&"backgroundFillSymbol"in t&&t.backgroundFillSymbol){var s=P.to3D(t.backgroundFillSymbol,!1,!0);s.symbol&&"web-style"!==s.symbol.type&&(r=s.symbol.symbolLayers)}var a=q.make(n,this.symbolCreationContext,r);return a.then(function(){return i.notifyChange("maxSymbolComplexity")}),a},t.prototype.getOrCreateGraphics3DSymbol=function(e,t){var i=this,r=this.symbols.get(e.id);return void 0===r&&(r=e instanceof l.WebStyleSymbol?new A(e,function(e){return i.createGraphics3DSymbol(e,t)}):this.createGraphics3DSymbol(e,t),this.symbols.set(e.id,r)),r&&++r.referenced,r},t.prototype.addGraphics3DGraphic=function(e){this._usedMemory+=e.usedMemory,this.graphics.set(e.graphic.uid,e),this.numberOfGraphics++,this.updateLayerVisibility()},t.prototype.removeGraphics3DGraphic=function(e,t){this._usedMemory-=t,this.graphics.delete(e),this.numberOfGraphics--,this.updateLayerVisibility()},t.prototype.createGraphics3DGraphic=function(e,t){var i=t.graphic;if(delete this.graphicsWithoutSymbol[i.uid],this.symbols.has(e.symbol.id)){if(!this.graphics.has(i.uid)){var r=e.createGraphics3DGraphic(t),n=e.symbol.id;this.addGraphics3DGraphic(r),this.graphicsBySymbol.has(n)||this.graphicsBySymbol.set(n,new Map),this.graphicsBySymbol.get(n).set(i.uid,r),r.initialize(this.stageLayer,this.stage),r.isDraped()&&(this.graphicsDrapedUids.add(i.uid),this._set("hasDraped",!0)),r.centroid=null,"point"!==i.geometry.type&&r instanceof U&&(r.centroid=L.computeCentroid(i.geometry,this.viewSR)),this._updateUserVisibility(r),this.deconfliction&&this.deconfliction.addGraphic(r),this.labeling&&this.labeling.addGraphic(r),this.scaleVisibility&&this.scaleVisibility.updateVisibility(r),this.filterVisibility&&this.filterVisibility.updateVisibility(r),this.highlights&&this.highlights.addGraphic(r),this.owner.view.deconflictor.setInitialIconVisibilityFlag(this,r);var s=this.whenGraphics3DGraphicRequests[i.uid];return s&&(delete this.whenGraphics3DGraphicRequests[i.uid],s.resolve(r)),r}}else this.add([i])},t.prototype.rendererChange=function(e){var t=this;e!==this.currentRenderer&&(this.validateRenderer(e),O.hasGeometryOperations(e)?O.enableGeometryOperations().then(function(){t.layer.renderer===e&&t.currentRendererChange(e,!0)}):this.currentRendererChange(e,!1))},t.prototype.currentRendererChange=function(e,t){this.currentRenderer=e,this.rendererHasGeometryOperations=t;var i=this.symbolCreationContext.renderer;if(e!==i){this.symbolConversionCache.clear();var r=R.diff(i,e);this.updateUnchangedSymbolMappings(r,e,i),this.symbolCreationContext.renderer=e,m.isNone(r)||("complete"===r.type?this.recreateAllGraphics():"partial"===r.type&&(this.applyRendererDiff(r,e,i)?this.volatileGraphicsUpdated():this.recreateAllGraphics()),this.notifyChange("maxSymbolComplexity"))}},t.prototype.diffHasSymbolChange=function(e){for(var t in e.diff)switch(t){case"visualVariables":case"defaultSymbol":case"uniqueValueInfos":break;case"authoringInfo":case"fieldDelimiter":delete e.diff[t];break;default:return!0}return!1},t.prototype.applySymbolSetDiff=function(e,t,i,r){var n=this;e=e||[];for(var s=[],a=this,o=0,l=t=t||[];o<l.length;o++){!function(t){var r=a.graphicsBySymbol.get(t.id);r&&r.forEach(function(a,o){var l=a.graphic,p=n.layer instanceof V?n.layer:null;if(t!==i.defaultSymbol||i.getSymbol(D.hydrateGraphic(l,p))!==i.defaultSymbol){var h=a.usedMemory;e.length||i.defaultSymbol?s.push(l):n.graphicsWithoutSymbol[o]=l;var u=n.graphics.get(o);n._conditionalRemove(u,o),a.destroy(),r.delete(o),n.removeGraphics3DGraphic(o,h),n.updateLayerVisibility()}}),a._whenSymbolRemoved.forEach(function(e){return e(t.id)})}(l[o])}if(e.length||s.length){for(var p in this.graphicsWithoutSymbol)s.push(this.graphicsWithoutSymbol[p]);this.graphicsWithoutSymbol={},this.add(s)}this.updateHasDraped(),this._cleanupSymbols(),this.owner.view.labeler.setDirty()},t.prototype.applyUniqueValueRendererDiff=function(e,t,i){var r=e.diff.defaultSymbol,n=e.diff.uniqueValueInfos;if(r||n){var s=n?n.added.map(function(e){return e.symbol}):[],a=n?n.removed.map(function(e){return e.symbol}):[];if(n)for(var o=0;o<n.changed.length;o++)s.push(n.changed[o].newValue.symbol),a.push(n.changed[o].oldValue.symbol);return r?(i.defaultSymbol&&a.push(i.defaultSymbol),t.defaultSymbol&&s.push(t.defaultSymbol)):i.defaultSymbol&&s.length&&a.push(t.defaultSymbol),this.applySymbolSetDiff(s,a,t,i),delete e.diff.defaultSymbol,delete e.diff.uniqueValueInfos,!0}return!1},t.prototype.calculateUnchangedSymbolMapping=function(e,t,i){if(t instanceof o.UniqueValueRenderer&&i instanceof o.UniqueValueRenderer&&(m.isNone(e)||"partial"===e.type)){var r=e&&e.diff,n=r&&r.defaultSymbol,s=r&&r.uniqueValueInfos,a=void 0;return a=s?s.unchanged.map(function(e){return{oldId:e.oldValue.symbol.id,newId:e.newValue.symbol.id}}):i.uniqueValueInfos.map(function(e,i){return{oldId:e.symbol.id,newId:t.uniqueValueInfos[i].symbol.id}}),!n&&i.defaultSymbol&&a.push({oldId:i.defaultSymbol.id,newId:t.defaultSymbol.id}),a}return[]},t.prototype.updateSymbolMapping=function(e,t){var i="string"==typeof t?t:t.id,r="string"==typeof t?null:t;if(e&&e!==i){var n=this.graphicsBySymbol.get(e);this.graphicsBySymbol.delete(e),void 0!==n&&this.graphicsBySymbol.set(i,n);var s=this.symbols.get(e);this.symbols.delete(e),void 0!==s&&(this.symbols.set(i,s),r?s.symbol=r:s.symbol.id=i)}},t.prototype.updateUnchangedSymbolMappings=function(e,t,i){for(var r=0,n=this.calculateUnchangedSymbolMapping(e,t,i);r<n.length;r++){var s=n[r],a=s.oldId,o=s.newId;this.updateSymbolMapping(a,o)}},t.prototype.applyRendererDiff=function(e,t,i){var r=this;return!this.diffHasSymbolChange(e)&&(!!(t instanceof o.UniqueValueRenderer&&i instanceof o.UniqueValueRenderer&&this.applyUniqueValueRendererDiff(e,t,i)&&0===Object.keys(e.diff).length)||y.everyMap(this.graphicsBySymbol,function(i,n){var s=r.symbols.get(n);if(s&&!s.applyRendererDiff(e,t))return!1}))},t.prototype.opacityChange=function(){this.forEachGraphics3DSymbol(function(e){return e.globalPropertyChanged("opacity")}),this.updateStageLayerVisibility()},t.prototype.slicePlaneEnabledChange=function(e){e!==this.symbolCreationContext.slicePlaneEnabled&&(this.symbolCreationContext.slicePlaneEnabled=e,this.stageLayer.isSliceable=e,this.forEachGraphics3DSymbol(function(e,t){return e.globalPropertyChanged("slicePlaneEnabled",t)}),this.deconfliction&&this.deconfliction.slicePlaneEnabledChange(),this.labeling&&this.labeling.slicePlaneEnabledChange())},t.prototype.pixelRatioChange=function(e){var t=this;this.forEachGraphics3DSymbol(function(e,i,r){e.globalPropertyChanged("pixelRatio",i)||t._recreateSymbol(r)})},t.prototype.setClippingExtent=function(e,t){var i=this.symbolCreationContext.clippingExtent,r=G.create();return T.extentToBoundingRect(e,r,t)?this.symbolCreationContext.clippingExtent=[r[0],r[1],-1/0,r[2],r[3],1/0]:this.symbolCreationContext.clippingExtent=null,!h.equals(this.symbolCreationContext.clippingExtent,i)},t.prototype.notifyVisibilityChanged=function(){this.owner.view.deconflictor.setDirty(),this.owner.view.labeler.setDirty()},t.prototype.forEachGraphics3DGraphic=function(e){var t=this;if(this.owner.loadedGraphics){var i=!1;this.owner.loadedGraphics.forEach(function(r){var n=t.getGraphics3DGraphicById(r.uid);n&&e(n,r)&&(i=!0)}),i&&this.notifyVisibilityChanged()}},t.prototype.forEachGraphics3DSymbol=function(e){var t=this;this.graphicsBySymbol.forEach(function(i,r){var n=t.symbols.get(r);n&&e(n,i,r)})},t.prototype.updateAllGraphicsVisibility=function(){var e=this;this.filterVisibility&&(this.filterVisibility.dirty=!0),this.forEachGraphics3DGraphic(function(t){var i=e._updateUserVisibility(t),r=e.scaleVisibility&&e.scaleVisibility.updateVisibility(t);return i||r})},t.prototype.hideAllGraphics=function(){this.forEachGraphics3DGraphic(function(e){return e.setVisibilityFlag(0,!1,0)})},t.prototype.validateRenderer=function(e){var t=I.validateTo3D(e);if(t){var i="Renderer for layer '"+(this.layer.title?this.layer.title+", ":"")+", id:"+this.layer.id+"' is not supported in a SceneView";N.warn(i,t.message)}},t.prototype.volatileGraphicsUpdated=function(){this.labeling&&(this.lastFastUpdate=b(),this.labeling.reset()),this.stageLayer.invalidateSpatialQueryAccelerator(),this.stageLayer.shaderTransformationChanged(),this.notifyChange("updating")},t.prototype._cleanupSymbols=function(){var e=this;if(!(this.graphicsWaitingForSymbol.size>0)){var t=!1;this.symbols.forEach(function(i,r){if(i&&!(i.referenced>0)){var n=e.graphicsBySymbol.get(r);n&&0!==n.size||(e.graphicsBySymbol.delete(r),e.symbols.delete(r),i&&i.destroy(),t=!0)}}),t&&this.notifyChange("maxSymbolComplexity")}},t.prototype.snapshotInternals=function(){var e=this;return{graphics:h.keysOfMap(this.graphics).sort(),symbols:h.keysOfMap(this.symbols).sort(),graphicsBySymbol:h.keysOfMap(this.graphicsBySymbol).sort().map(function(t){return{symbolId:t,graphics:h.keysOfMap(e.graphicsBySymbol.get(t)).sort()}}),graphicsWithoutSymbol:Object.keys(this.graphicsWithoutSymbol).sort(),graphicsDrapedUids:h.keysOfSet(this.graphicsDrapedUids).sort(),pendingUpdates:this.pendingUpdates}},Object.defineProperty(t.prototype,"test",{get:function(){return{symbols:this.symbols,filterVisibility:this.filterVisibility}},enumerable:!0,configurable:!0}),t.prototype.getStats=function(){return{coreVisible:this.graphics.size,coreMissing:Object.keys(this.graphicsWithoutSymbol).length,corePending:this.pendingUpdates.size}},t.tmpVec=_.vec3f64.create(),r([C.property({readOnly:!0})],t.prototype,"computedExtent",void 0),r([C.property()],t.prototype,"currentRenderer",void 0),r([C.property()],t.prototype,"rendererHasGeometryOperations",void 0),r([C.property({readOnly:!0})],t.prototype,"elevationAlignment",void 0),r([C.property({readOnly:!0})],t.prototype,"scaleVisibility",void 0),r([C.property({readOnly:!0})],t.prototype,"filterVisibility",void 0),r([C.property({readOnly:!0})],t.prototype,"spatialIndex",void 0),r([C.property({readOnly:!0})],t.prototype,"deconfliction",void 0),r([C.property({readOnly:!0})],t.prototype,"labeling",void 0),r([C.property({readOnly:!0})],t.prototype,"highlights",void 0),r([C.property()],t.prototype,"asyncUpdates",void 0),r([C.property({constructOnly:!0})],t.prototype,"elevationFeatureExpressionEnabled",void 0),r([C.property({constructOnly:!0})],t.prototype,"owner",void 0),r([C.property({constructOnly:!0})],t.prototype,"layer",void 0),r([C.property({readOnly:!0})],t.prototype,"hasDraped",void 0),r([C.property({readOnly:!0})],t.prototype,"symbolsUpdating",void 0),r([C.property({constructOnly:!0})],t.prototype,"graphicSymbolSupported",void 0),r([C.property({readOnly:!0,dependsOn:["elevationAlignment.updating","scaleVisibility.updating","filterVisibility.updating"]})],t.prototype,"updating",null),r([C.property({readOnly:!0})],t.prototype,"updatingRemaining",null),r([C.property({readOnly:!0})],t.prototype,"updatingTotal",null),r([C.property({readOnly:!0,dependsOn:["owner.view.qualitySettings.graphics3D.maxTotalNumberOfPrimitives","owner.view.qualitySettings.graphics3D.maxTotalNumberOfFeatures","maxSymbolComplexity"]})],t.prototype,"displayFeatureLimit",null),r([C.property({readOnly:!0})],t.prototype,"maxSymbolComplexity",null),p=r([C.subclass("esri.views.3d.layers.graphics.Graphics3DCore")],t)}(C.declared(p)),Z=new Map,K=new x,$=new v(x),ee=10;return J}.apply(null,r))||(e.exports=n)},1577:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(13),i(560)],void 0===(n=function(e,t,i,r){function n(e,t){if(!t)return null;var r;if((r=Array.isArray(t)?t:[t]).length>0){var n=r.map(function(e){return e.details.symbol.type||e.details.symbol.declaredClass}).filter(function(e){return!!e});n.sort();var s=[];return n.forEach(function(e,t){0!==t&&e===n[t-1]||s.push(e)}),new i("renderer-conversion-3d:unsupported-symbols","Renderer contains symbols ("+s.join(", ")+") which are not supported in 3D",{renderer:e,symbolErrors:r})}return null}Object.defineProperty(t,"__esModule",{value:!0}),t.validateTo3D=function(e){return e?function(e){return"simple"===e.type}(e)?function(e){return n(e,r.to3D(e.symbol).error)}(e):function(e){return"unique-value"===e.type}(e)?function(e){var t=e.uniqueValueInfos.map(function(e){return r.to3D(e.symbol).error}).filter(function(e){return!!e}),i=r.to3D(e.defaultSymbol);return i.error&&t.unshift(i.error),n(e,t)}(e):function(e){return"class-breaks"===e.type}(e)?function(e){var t=e.classBreakInfos.map(function(e){return r.to3D(e.symbol).error}).filter(function(e){return!!e}),i=r.to3D(e.defaultSymbol);return i.error&&t.unshift(i.error),n(e,t)}(e):new i("renderer-conversion-3d:unsupported-renderer","Unsupported renderer of type '"+(e.type||e.declaredClass)+"'",{renderer:e}):null}}.apply(null,r))||(e.exports=n)},1578:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(){this.sharedResources=null,this.streamDataSupplier=null,this.elevationProvider=null,this.renderer=null,this.stage=null,this.layerOrder=null,this.layerOrderDelta=null,this.clippingExtent=null,this.renderSpatialReference=null,this.renderCoordsHelper=null,this.overlaySR=null,this.layer=null,this.layerView=null,this.localOriginFactory=null,this.featureExpressionInfoContext=null,this.screenSizePerspectiveEnabled=!0,this.slicePlaneEnabled=!1,this.isAsync=!1}}();t.Graphics3DSymbolCreationContext=i}.apply(null,r))||(e.exports=n)},1579:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1580),i(561)],void 0===(n=function(e,t,i,r){Object.defineProperty(t,"__esModule",{value:!0}),t.make=function(e,t,n){var s;switch(e.type){case"point-3d":s=i;break;default:s=r}return new s(e,t,n)}}.apply(null,r))||(e.exports=n)},1580:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(5),i(569),i(561)],void 0===(n=function(e,t,i,r,n){return function(e){function t(t,i,n){var s=e.call(this,t,i,n)||this;return s.calloutSymbolLayer=null,s.symbol.hasVisibleCallout()&&(s.calloutSymbolLayer=r.make(s.symbol,i)),s}return i(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this)},t.prototype.createGraphics3DGraphic=function(t,i,r){var n=e.prototype.createGraphics3DGraphic.call(this,t,r);if(this.calloutSymbolLayer){var s=this.createCalloutGraphic(t);s&&n.addAuxiliaryGraphic(s)}return n},t.prototype.globalPropertyChanged=function(t,i){var r=this;if(!e.prototype.globalPropertyChanged.call(this,t,i))return!1;if(this.calloutSymbolLayer){return this.calloutSymbolLayer.globalPropertyChanged(t,i,function(e){for(var t=0,i=e._auxiliaryGraphics;t<i.length;t++){var n=i[t];if(n.graphics3DSymbolLayer===r.calloutSymbolLayer)return n}})}return!0},t.prototype.createCalloutGraphic=function(e){var t=e.renderingInfo,i={renderer:t.renderer,symbol:t.symbol,translation:[0,0,0],centerOffset:[0,0,0,0],screenOffset:[0,0],centerOffsetUnits:"world",elevationOffset:0,materialCollection:null};return e.renderingInfo=i,this.calloutSymbolLayer.createGraphics3DGraphic(e)},t}(n)}.apply(null,r))||(e.exports=n)},1581:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(6),i(17),i(88),i(0),i(37)],void 0===(n=function(e,t,i,r,n,s,a,o,l){var p=function(){function e(){this.extents=new a({allocator:function(e){return e||l.create()}}),this.tempExtent=l.create(),this.dirty=!1}return Object.defineProperty(e.prototype,"length",{get:function(){return this.extents.length},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this.extents.clear()},e.prototype.add=function(e){this.contains(e)||(this.removeContained(e),l.set(this.extents.pushNew(),e),this.dirty=!0)},e.prototype.pop=function(){return this.dirty&&(this.mergeTight(),this.dirty=!1),this.extents.pop()},e.prototype.mergeTight=function(){for(var e=this.extents,t=this.tempExtent,i=!1;!i;){i=!0;for(var r=0;r<e.length;++r)if(function(i){for(var r=e.data[i],n=l.area(r),s=!1,a=e.length-1;a>i;--a){var o=e.data[a],p=l.area(o);l.expand(r,o,t);var h=n+p;(l.area(t)-h)/h<.05&&(l.set(r,t),n=l.area(r),e.swapElements(a,e.length-1),e.pop(),s=!0)}return s}(r)){i=!1;break}}},e.prototype.contains=function(e){return this.extents.some(function(t){return l.contains(t,e)})},e.prototype.removeContained=function(e){for(var t=this.extents.length-1;t>=0;--t)l.contains(e,this.extents.data[t])&&this.extents.removeUnorderedIndex(t)},e}();return function(e){function t(){var t=e.call(this)||this;return t.dirtyExtents=new p,t.globalDirty=!1,t.dirtyGraphicsQueue=new a({deallocator:null}),t.handles=new s,t.updateElevation=!1,t.layerView=null,t.graphicsCore=null,t}return i(t,e),Object.defineProperty(t.prototype,"updating",{get:function(){return this.needsUpdate()},enumerable:!0,configurable:!0}),t.prototype.setup=function(e,t,i,r){var n=this;this.layerView=e,this.queryGraphicUIDsInExtent=t,this.graphicsCore=i,this.elevationProvider=r;var s=this.layerView.view.resourceController.scheduler;this.handles.add([r.on("elevation-change",function(e){return n.elevationUpdateHandler(e)}),this.layerView.watch("suspended",function(){return n.suspendedChange()}),s.registerTask(12,function(e){return n.update(e)},function(){return n.needsUpdate()})])},t.prototype.destroy=function(){this.dirtyGraphicsQueue=null,this.handles.destroy(),this.handles=null,this.layerView=null,this.graphicsCore=null,this.queryGraphicUIDsInExtent=null},t.prototype.clear=function(){this.dirtyGraphicsQueue.clear(),this.notifyChange("updating")},t.prototype.suspendedChange=function(){!0===this.layerView.suspended?this.updateElevation=!1:!1===this.layerView.suspended&&this.updateElevation&&(this.globalDirty=!0,this.notifyChange("updating"))},t.prototype.elevationInfoChange=function(){this.globalDirty=!0,this.notifyChange("updating")},t.prototype.needsUpdate=function(){return this.dirtyGraphicsQueue.length>0||this.dirtyExtents.length>0||this.globalDirty},t.prototype.update=function(e){for(this.globalDirty&&(this.markAllGraphicsElevationDirty(),this.globalDirty=!1,e.madeProgress());this.needsUpdate()&&!e.done;)this._updateDirtyGraphics(e),this._updateDirtyExtents(e);this.layerView.view.deconflictor.setDirty(),this.notifyChange("updating")},t.prototype._updateDirtyGraphics=function(e){for(var t=this.layerView.view,i=this.graphicsCore.stageLayer.id,r=this.layerView.labeling;this.dirtyGraphicsQueue.length>0&&!e.done;){for(var n=Math.min(this.dirtyGraphicsQueue.length,100);n--&&!e.done;){var s=this.dirtyGraphicsQueue.pop(),a=this.graphicsCore.getGraphics3DGraphicById(s);a&&a.alignWithElevation(this.elevationProvider,t.renderCoordsHelper),e.madeProgress()}t._stage.processDirtyLayer(i),r&&r.processStageDirty()}},t.prototype._updateDirtyExtents=function(e){for(var t=this;this.dirtyExtents.length>0&&this.dirtyGraphicsQueue.length<100&&!e.done;){var i=this.dirtyExtents.pop();this.queryGraphicUIDsInExtent(i,this.spatialReference,function(e){var i=t.graphicsCore.getGraphics3DGraphicById(e);i&&i.needsElevationUpdates()&&t.dirtyGraphicsQueue.push(e)}),e.madeProgress()}},t.prototype.markAllGraphicsElevationDirty=function(){var e=this;this.dirtyExtents.clear(),this.dirtyGraphicsQueue.clear(),this.graphicsCore.graphics3DGraphics.forEach(function(t,i){return e.dirtyGraphicsQueue.push(i)})},t.prototype.elevationUpdateHandler=function(e){var t=e.extent;if(this.layerView.suspended){if(!this.updateElevation){var i=this.graphicsCore.computedExtent;i&&t[2]>i.xmin&&t[0]<i.xmax&&t[3]>i.ymin&&t[1]<i.ymax&&(this.updateElevation=!0)}}else t[0]===-1/0?this.globalDirty=!0:this.dirtyExtents.add(t),this.spatialReference=e.spatialReference,this.notifyChange("updating")},r([o.property({readOnly:!0})],t.prototype,"updating",null),r([o.subclass("esri.views.3d.layers.graphics.Graphics3DElevationAlignment")],t)}(o.declared(n))}.apply(null,r))||(e.exports=n)},1582:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1583)],void 0===(n=function(e,t,i){return function(){function e(){this.graphicsCore=null,this.highlights=[]}return e.prototype.destroy=function(){this.highlights.forEach(function(e){return e.highlightSet.removeAll()}),this.highlights=null},e.prototype.setup=function(e){this.graphicsCore=e},e.prototype.acquireSet=function(e,t){var r=this,n=new i(e,t);return this.highlights.push(n),{set:n,handle:{remove:function(){return r.releaseSet(n)},pause:function(){n.highlightSet.removeAll(),n.paused=!0},resume:function(){n.paused=!1,r.initializeSet(n)}}}},e.prototype.releaseSet=function(e){e.highlightSet.removeAll();var t=this.highlights?this.highlights.indexOf(e):-1;-1!==t&&this.highlights.splice(t,1)},e.prototype.setUids=function(e,t){for(var i=this.graphicsCore.graphics3DGraphics,r=0,n=t;r<n.length;r++){var s=n[r];e.ids.add(s);var a=i.get(s);a&&a.addHighlight(e.highlightSet,e.options)}},e.prototype.setObjectIds=function(e,t){t.forEach(function(t){return e.ids.add(t)}),this.initializeSet(e)},e.prototype.addGraphic=function(e){this.highlights.forEach(function(t){!t.paused&&t.hasGraphic(e)&&e.addHighlight(t.highlightSet,t.options)})},e.prototype.removeGraphic=function(e){this.highlights.forEach(function(t){t.hasGraphic(e)&&e.removeHighlight(t.highlightSet)})},e.prototype.allGraphicsDeleted=function(){this.highlights.forEach(function(e){return e.highlightSet.removeAll()})},e.prototype.initializeSet=function(e){var t=this.graphicsCore.graphics3DGraphics;e.objectIdField?t.forEach(function(t){t&&e.hasGraphic(t)&&t.addHighlight(e.highlightSet,e.options)}):e.ids.forEach(function(i){var r=t.get(i);r&&r.addHighlight(e.highlightSet,e.options)})},e}()}.apply(null,r))||(e.exports=n)},1583:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1551)],void 0===(n=function(e,t,i){return function(){function e(e,t){this.highlightSet=new i,this.ids=new Set,this.paused=!1,this.options=e,this.objectIdField=t}return e.prototype.hasGraphic=function(e){if(this.objectIdField){var t=e.graphic.attributes[this.objectIdField];return this.ids.has(t)}return this.ids.has(e.graphic.uid)},e}()}.apply(null,r))||(e.exports=n)},1584:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(6),i(17),i(0)],void 0===(n=function(e,t,i,r,n,s,a){function o(e,t){return null!==e&&e>0&&e<8e7||t>50}return function(e){function t(){var t=e.call(this)||this;return t._scaleRangeActive=!1,t._layerScaleRangeVisibilityDirty=!0,t.layerScaleRangeVisibilityQuery=!1,t.scaleChangeEventHandle=null,t.handles=new s,t.layerView=null,t.layer=null,t.queryGraphicUIDsInExtent=null,t.extent=null,t.graphicsCore=null,t.basemapTerrain=null,t.suspended=!1,t}return i(t,e),Object.defineProperty(t.prototype,"layerScaleRangeVisibilityDirty",{get:function(){return this._layerScaleRangeVisibilityDirty},set:function(e){this._layerScaleRangeVisibilityDirty!==e&&(this._layerScaleRangeVisibilityDirty=e,this.notifyChange("updating"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return this.layerView.view.basemapTerrain&&this.layerScaleRangeVisibilityDirty},enumerable:!0,configurable:!0}),t.prototype.setup=function(e,t,i,r,n){var s=this;this.layerView=e,this.layer=t,this.queryGraphicUIDsInExtent=i,this.graphicsCore=r,this.basemapTerrain=n,this.updateScaleRangeActive();var a=this.layerView.view.resourceController.scheduler;this.handles.add(a.registerTask(6,function(){return s.update()},function(){return s.needsUpdate()}))},t.prototype.destroy=function(){this.scaleChangeEventHandle&&(this.scaleChangeEventHandle.remove(),this.scaleChangeEventHandle=null),this.handles.destroy(),this.handles=null,this.layerView=null,this.extent=null,this.queryGraphicUIDsInExtent=null,this.graphicsCore=null},t.prototype.needsUpdate=function(){return this.layerView.view.basemapTerrain&&this.layerScaleRangeVisibilityDirty},t.prototype.setExtent=function(e){this.extent=e,this.layerScaleRangeVisibilityDirty=!0},t.prototype.update=function(){this.updateSuspendScaleVisible(),this.layerScaleRangeVisibilityDirty=!1},t.prototype.scaleRangeActive=function(){return this._scaleRangeActive},t.prototype.updateScaleRangeActive=function(){var e=this,t=this.layer,i=o(t.minScale,t.maxScale);t.labelingInfo&&!i&&(i=t.labelingInfo.some(function(e){return e&&o(e.minScale,e.maxScale)}));var r=this._scaleRangeActive!==i;return this._scaleRangeActive=i,i&&!this.scaleChangeEventHandle&&this.basemapTerrain?this.scaleChangeEventHandle=this.basemapTerrain.on("scale-change",function(t){return e.scaleUpdateHandler(t)}):!i&&this.scaleChangeEventHandle&&(this.scaleChangeEventHandle.remove(),this.scaleChangeEventHandle=null),r},t.prototype.updateSuspendScaleVisibleFinish=function(e){this.layerScaleRangeVisibilityQuery=!1,this._set("suspended",!e)},t.prototype.updateSuspendScaleVisible=function(){var e=this,t=this.layerView.view.basemapTerrain;this.extent&&t&&this._scaleRangeActive?this.layerScaleRangeVisibilityQuery||(this.layerScaleRangeVisibilityQuery=!0,t.queryVisibleScaleRange(this.extent,this.layer.minScale,this.layer.maxScale,function(t){return e.updateSuspendScaleVisibleFinish(t)})):this.updateSuspendScaleVisibleFinish(!0)},t.prototype.visibleAtScale=function(e,t,i){return null==e||e>i&&(!t||e<t)},t.prototype.visibleAtLayerScale=function(e){return this.visibleAtScale(e,this.layer.minScale,this.layer.maxScale)},t.prototype.visibleAtLabelScale=function(e,t){return this.visibleAtScale(e,t.minScale,t.maxScale)},t.prototype.graphicScale=function(e){var t;return e.centroid?t=e.centroid:"point"===e.graphic.geometry.type&&(t=e.graphic.geometry),t?this.layerView.view.basemapTerrain?this.layerView.view.basemapTerrain.getScale(t):1:null},t.prototype.graphicVisible=function(e){var t=this.graphicScale(e);return this.visibleAtLayerScale(t)},t.prototype.updateVisibility=function(e){if(this._scaleRangeActive){var t=this.graphicVisible(e);return e.setVisibilityFlag(1,t,0)}return!1},t.prototype.updateGraphicLabelScaleVisibility=function(e){if(!this._scaleRangeActive)return!1;if(!e._labelGraphics||0===e._labelGraphics.length)return!1;var t=this.graphicScale(e),i=this.updateLabelScaleVisibility(e,t);return i&&(this.layerView.view.deconflictor.setDirty(),this.layerView.view.labeler.setDirty()),i},t.prototype.updateLabelScaleVisibility=function(e,t){if(!e._labelGraphics||0===e._labelGraphics.length)return!1;var i=e._labelGraphics[0]._labelClass;if(i&&null!=i.minScale&&null!=i.maxScale){var r=this.visibleAtLabelScale(t,i);if(e.setVisibilityFlag(1,r,1))return!0}return!1},t.prototype.scaleUpdateHandler=function(e){var t=this;if(!this.layerView.suspended){var i=e.extent,r=e.scale,n=this.visibleAtLayerScale(r),s=!1;this.queryGraphicUIDsInExtent(i,e.spatialReference,function(e){var a=t.graphicsCore.getGraphics3DGraphicById(e);if(a){var o=a.centroid;if(o&&(i[0]>o.x||i[1]>o.y||i[2]<o.x||i[3]<o.y))return;var l=!1;a.setVisibilityFlag(1,n,0)&&(l=!0),t.updateLabelScaleVisibility(a,r)&&(l=!0),l&&(s=!0)}}),s&&(this.layerView.view.deconflictor.setDirty(),this.layerView.view.labeler.setDirty())}this.layerScaleRangeVisibilityDirty=!0},t.prototype.layerMinMaxScaleChangeHandler=function(){this.updateScaleRangeActive()&&(this._scaleRangeActive?this.graphicsCore.updateAllGraphicsVisibility():this.graphicsCore.forEachGraphics3DGraphic(function(e){return e.clearVisibilityFlag(1)})),this.layerScaleRangeVisibilityDirty=!0},r([a.property({readOnly:!0})],t.prototype,"suspended",void 0),r([a.property({readOnly:!0})],t.prototype,"updating",null),r([a.subclass("esri.views.3d.layers.graphics.Graphics3DScaleVisibility")],t)}(a.declared(n))}.apply(null,r))||(e.exports=n)},1585:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(6),i(19),i(88),i(0),i(1558)],void 0===(n=function(e,t,i,r,n,s,a,o,l){var p=function(e){function t(t){var i=e.call(this)||this;return i.index=new l.default(9,s("csp-restrictions")?function(e){return{minX:e.extent[0],minY:e.extent[1],maxX:e.extent[2],maxY:e.extent[3]}}:[".extent[0]",".extent[1]",".extent[2]",".extent[3]"]),i.spatialReference=null,i}return i(t,e),t.prototype.destroy=function(){this.index.destroy(),this.index=null,h.prune()},t.prototype.queryGraphicUIDsInExtent=function(e,t,i){t.equals(this.spatialReference)&&(u.minX=e[0],u.minY=e[1],u.maxX=e[2],u.maxY=e[3],this.index.search(u,function(e){return i(e.graphic.uid)}))},t.prototype.add=function(e){!e.addedToSpatialIndex&&e.computeExtent(this.spatialReference)&&(this.index.insert(e),e.addedToSpatialIndex=!0)},t.prototype.addMany=function(e,t){void 0===t&&(t=e.length),h.clear();for(var i=0;i<t;i++){var r=e[i];!r.addedToSpatialIndex&&r.computeExtent(this.spatialReference)&&(h.push(r),r.addedToSpatialIndex=!0)}this.index.load(h.data,h.length)},t.prototype.remove=function(e){e.addedToSpatialIndex&&(e.addedToSpatialIndex=!1,this.index.remove(e))},t.prototype.clear=function(){this.index.clear()},r([o.property({constructOnly:!0})],t.prototype,"spatialReference",void 0),r([o.subclass("esri.views.3d.layers.graphics.Graphics3DSpatialIndex")],t)}(o.declared(n)),h=new a,u={minX:0,minY:0,maxX:0,maxY:0};return p}.apply(null,r))||(e.exports=n)},1596:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.attributeLookup=function(e,t){for(var i=t.toLowerCase(),r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];if(s.toLowerCase()===i)return e[s]}return null}}.apply(null,r))||(e.exports=n)},1636:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){function i(e,t){if(!e||e.symbol)return null;var i=t.renderer;return e&&i&&i.getObservationRenderer?i.getObservationRenderer(e):i}function r(e,t){if(e.symbol)return e.symbol;var r=i(e,t);return r&&r.getSymbol(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.getRenderer=i,t.getSymbol=r,t.getRenderingInfo=function(e,t){var n=i(e,t),s=r(e,t);if(!s)return null;var a={renderer:n,symbol:s};if(!(n&&"visualVariables"in n&&n.visualVariables))return a;for(var o=["proportional","proportional","proportional"],l=0,p=n.getVisualVariableValues(e,t);l<p.length;l++){var h=p[l],u=h.variable,c=h.value;if("color"===u.type)a.color=c.toRgba();else if("size"===u.type)if("outline"===u.target)a.outlineSize=c;else{var d=u.axis,y=u.useSymbolValue?"symbolValue":c;"width"===d?o[0]=y:"depth"===d?o[1]=y:"height"===d?o[2]=y:o[0]=o[1]="width-and-depth"===d?y:o[2]=y}else"opacity"===u.type?a.opacity=c:"rotation"===u.type&&"tilt"===u.axis?a.tilt=c:"rotation"===u.type&&"roll"===u.axis?a.roll=c:"rotation"===u.type&&(a.heading=c)}return(isFinite(o[0])||isFinite(o[1])||isFinite(o[2]))&&(a.size=o),a}}.apply(null,r))||(e.exports=n)},1637:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(79),i(6),i(23),i(17),i(9),i(21),i(0),i(44),i(555),i(353),i(1575),i(1576),i(1581),i(1638),i(1574),i(1582),i(1584),i(1585),i(72),i(1596)],void 0===(n=function(e,t,i,r,n,s,a,o,l,p,h,u,c,d,y,f,g,m,b,v,x,w,S,C){var _=function(e){function t(t){var i=e.call(this)||this;return i._handles=new o,i.highlights=new v,i.suspendResumeExtentMode="computed",i.dataExtent=null,i.suspendResumeExtent=null,i}return i(t,e),Object.defineProperty(t.prototype,"suspended",{get:function(){return this.scaleVisibility&&this.scaleVisibility.suspended||this.frustumVisibility&&this.frustumVisibility.suspended},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return!!(this.graphicsCore&&this.graphicsCore.updating||this.frustumVisibility&&this.frustumVisibility.updating)},enumerable:!0,configurable:!0}),t.prototype.normalizeCtorArgs=function(e){var t=!e.queryGraphicUIDsInExtent&&(e.scaleVisibilityEnabled||e.elevationAlignmentEnabled)?new w({spatialReference:e.owner.view.spatialReference}):null,i=e.frustumVisibilityEnabled?new b:null,r=e.scaleVisibilityEnabled?new x:null,n=e.filterVisibilityEnabled&&"multipatch"!==e.layer.geometryType?new m.Graphics3DFilterVisibility({geometryType:e.layer.geometryType}):null,s=e.elevationAlignmentEnabled?new g:null,a=new f({owner:e.owner,layer:e.layer,asyncUpdates:e.asyncGraphicsUpdates,elevationFeatureExpressionEnabled:e.elevationFeatureExpressionEnabled,graphicSymbolSupported:!1}),o=e.updateClippingExtent,l=e.queryGraphicUIDsInExtent,p=e.suspendResumeExtentMode,h=e.dataExtent;return{graphicsCore:a,frustumVisibility:i,scaleVisibility:r,filterVisibility:n,elevationAlignment:s,spatialIndex:t,updateClippingExtent:o,suspendResumeExtentMode:p,dataExtent:h,queryGraphicUIDsInExtent:l||function(e,i,r){return t.queryGraphicUIDsInExtent(e,i,r)}}},t.prototype.initialize=function(){var e=this;this.scaleVisibility&&this._handles.add(this.layer.watch(["minScale","maxScale"],function(){return e.scaleVisibility.layerMinMaxScaleChangeHandler()})),this.filterVisibility&&this._handles.add(this.owner.watch("filter",function(){return e.filterVisibility.filterChanged()})),this.elevationAlignment&&this._handles.add(this.layer.watch("elevationInfo",function(t,i){c.diff(t,i)&&e.graphicsCore.elevationInfoChange()})),this._handles.add(this.layer.watch("labelsVisible",function(){return e.graphicsCore.updateVisibilityInfo()})),this._handles.add(this.layer.watch("labelingInfo",function(t,i){c.diff(t,i)&&e.graphicsCore.updateLabelingInfo()}))},t.prototype.setup=function(){var e=this;this.frustumVisibility&&this.frustumVisibility.setup(this.owner);var t=this.owner,i=this.owner.view.basemapTerrain;if(this.scaleVisibility&&this.scaleVisibility.setup(t,this.layer,this.queryGraphicUIDsInExtent,this.graphicsCore,i),this.filterVisibility&&this.filterVisibility.setup(t,this.graphicsCore),this.elevationAlignment){var r=t.view.elevationProvider;this.elevationAlignment.setup(t,this.queryGraphicUIDsInExtent,this.graphicsCore,r)}return this.highlights&&this.highlights.setup(this.graphicsCore),this._set("labeling",this.owner.view.labeler.addGraphicsOwner(this.graphicsCore,this.scaleVisibility,this.spatialIndex)),this._set("deconfliction",t.view.deconflictor.addGraphicsOwner(this.graphicsCore)),this.graphicsCore.setup({elevationAlignment:this.elevationAlignment,scaleVisibility:this.scaleVisibility,filterVisibility:this.filterVisibility,spatialIndex:this.spatialIndex,deconfliction:this.deconfliction,labeling:this.labeling,highlights:this.highlights}),this._handles.add([this.layer.watch("renderer",function(t){return e.graphicsCore.rendererChange(t)}),t.watch("fullOpacity",function(){return e.graphicsCore.opacityChange()})]),this.setupSuspendResumeExtent(),this.updateClippingExtent&&(this._handles.add(t.view.watch("clippingArea",function(){return e._updateClippingExtent()})),this._updateClippingExtent()),this.graphicsCore.startCreateGraphics(),this.graphicsCore.labelsEnabled?this.graphicsCore.updateLabelingInfo():l.resolve()},t.prototype.destroy=function(){this._handles&&(this._handles.destroy(),this._handles=null);for(var e=0,t=["frustumVisibility","scaleVisibility","filterVisibility","elevationAlignment","highlights","graphicsCore","spatialIndex"];e<t.length;e++){var i=t[e],r=this[i];r&&(r.destroy(),this._set(i,null))}this._set("layer",null),this._set("owner",null)},t.prototype.highlight=function(e,t,i){var r=this;if(e instanceof d){var s=this.highlights.acquireSet(t,i),a=s.set,o=s.handle;return this.owner.queryObjectIds(e).then(function(e){return r.highlights.setObjectIds(a,e)}),o}if("number"==typeof e)return this.highlight([e],t,i);if(e instanceof n)return this.highlight([e],t,i);if("toArray"in e&&(e=e.toArray()),Array.isArray(e)&&e.length>0){if(e[0]instanceof n){var l=e;if(!i||!l[0].attributes||null===C.attributeLookup(l[0].attributes,i)){var p=l.map(function(e){return e.uid}),h=this.highlights.acquireSet(t,null),u=h.set;o=h.handle;return this.highlights.setUids(u,p),o}e=l.map(function(e){return C.attributeLookup(e.attributes,i)})}if("number"==typeof e[0]){var c=e,y=this.highlights.acquireSet(t,i);u=y.set,o=y.handle;return this.highlights.setObjectIds(u,c),o}}return G},t.prototype._updateClippingExtent=function(){var e=this.owner.view.clippingArea;this.graphicsCore.setClippingExtent(e,this.owner.view.spatialReference)&&(this.updateClippingExtent(e)||this.graphicsCore.recreateAllGraphics())},t.prototype.setupSuspendResumeExtent=function(){var e=this;(this.frustumVisibility||this.scaleVisibility)&&this._handles.add(p.init(this,"suspendResumeExtentMode",function(){switch(e._handles.remove(E),e.suspendResumeExtentMode){case"computed":e._handles.add(p.init(e.graphicsCore,"computedExtent",function(t){return e.updateSuspendResumeExtent(t)}),E);break;case"data":e._handles.add(p.init(e,"dataExtent",function(t){return e.updateSuspendResumeExtent(t)}),E);break;default:a.neverReached(e.suspendResumeExtentMode)}}))},t.prototype.updateSuspendResumeExtent=function(e){e?this.suspendResumeExtentChanged(this.extentToSuspendResumeRect(e,this.suspendResumeExtent)):this.suspendResumeExtentChanged(null)},t.prototype.extentToSuspendResumeRect=function(e,t){var i=this.owner.view.spatialReference;if(!e.spatialReference.equals(i)){if(!u.canProject(e,i))return;e=u.project(e,i)}return S.enlargeExtent(e,t,y.SUSPEND_RESUME_EXTENT_OPTIMISM)},t.prototype.suspendResumeExtentChanged=function(e){this.frustumVisibility&&this.frustumVisibility.setExtent(e),this.scaleVisibility&&this.scaleVisibility.setExtent(e)},r([h.property({aliasOf:"graphicsCore.layer"})],t.prototype,"layer",void 0),r([h.property({aliasOf:"graphicsCore.owner"})],t.prototype,"owner",void 0),r([h.property({constructOnly:!0})],t.prototype,"updateClippingExtent",void 0),r([h.property({constructOnly:!0})],t.prototype,"queryGraphicUIDsInExtent",void 0),r([h.property({constructOnly:!0})],t.prototype,"graphicsCore",void 0),r([h.property({constructOnly:!0})],t.prototype,"spatialIndex",void 0),r([h.property({constructOnly:!0})],t.prototype,"scaleVisibility",void 0),r([h.property({constructOnly:!0})],t.prototype,"filterVisibility",void 0),r([h.property({constructOnly:!0})],t.prototype,"elevationAlignment",void 0),r([h.property({constructOnly:!0})],t.prototype,"frustumVisibility",void 0),r([h.property({readOnly:!0})],t.prototype,"deconfliction",void 0),r([h.property({readOnly:!0})],t.prototype,"labeling",void 0),r([h.property({readOnly:!0})],t.prototype,"highlights",void 0),r([h.property()],t.prototype,"suspendResumeExtentMode",void 0),r([h.property()],t.prototype,"dataExtent",void 0),r([h.property({readOnly:!0,dependsOn:["scaleVisibility.suspended","frustumVisibility.suspended"]})],t.prototype,"suspended",null),r([h.property({readOnly:!0,dependsOn:["graphicsCore.updating","frustumVisibility.updating"]})],t.prototype,"updating",null),r([h.subclass("esri.views.3d.layers.graphics.Graphics3DFeatureLikeLayerView")],t)}(h.declared(s)),E="suspendResumeExtentMode",G={remove:function(){},pause:function(){},resume:function(){}};return _}.apply(null,r))||(e.exports=n)},1638:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(43),i(6),i(17),i(10),i(21),i(0),i(65),i(69),i(547),i(550),i(1544),i(1553)],void 0===(n=function(e,t,i,r,n,s,a,o,l,p,h,u,c,d,y,f){Object.defineProperty(t,"__esModule",{value:!0});var g=o.getLogger("esri.views.3d.layers.graphics.Graphics3DFilterVisibility"),m=function(e){function t(t){var i=e.call(this)||this;return i._dirty=!1,i._querying=!1,i._handles=new a,i}return i(t,e),Object.defineProperty(t.prototype,"updating",{get:function(){return this._dirty||this._querying||null!=this._queryResult},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"featureGeometryType",{get:function(){switch(this.geometryType){case"multipoint":case"point":case"polygon":case"polyline":return this.geometryType;case"mesh":case"extent":return"polygon"}},enumerable:!0,configurable:!0}),t.prototype.setup=function(e,t){var i=this;this._layerView=e,this._core=t,this._objectIdField=e.layer.objectIdField,e.layer.timeInfo&&(this._timeInfo=e.layer.timeInfo.toJSON()),this._scheduler=this._layerView.view.resourceController.scheduler,this._handles.add(this._scheduler.registerTask(4,function(e){return i._update(e)},function(){return i._needsUpdate()})),this._handles.add(l.on(t.owner,"loadedGraphics","change",function(e){return i._graphicsChanged(e)},function(){return i.dirty=!0}))},t.prototype.destroy=function(){this._handles.destroy(),this._handles=null,this.clear(),this._layerView=null,this._core=null},t.prototype.clear=function(){this._queryEngine&&(this._queryEngine.destroy(),this._queryEngine=null,this._queryResult=null,this._store=null,this._querying=!1,this._core.forEachGraphics3DGraphic(function(e){return e.clearVisibilityFlag(2)})),this.dirty=!1,this.notifyChange("updating")},t.prototype._graphicsChanged=function(e){if(this._queryEngine){if(e.removed&&e.removed.length>0){for(var t=new Array(e.removed.length),i=0;i<e.removed.length;++i)t[i]=e.removed[i].uid;this._store.removeManyById(t)}if(e.added&&e.added.length>0){var r=new Array(e.added.length);for(i=0;i<e.added.length;++i)r[i]=this._convertToOptimizedFeature(e.added[i]);this._store.addMany(r),this.dirty=!0}}else this.dirty=!0},t.prototype.updateVisibility=function(e){this._queryEngine&&(e.hasVisibilityFlag(2,0)||e.setVisibilityFlag(2,!1,0),this.dirty=!0)},t.prototype.filterChanged=function(){this.dirty=!0},Object.defineProperty(t.prototype,"active",{get:function(){return this._layerView.filter&&this._core.owner.loadedGraphics.length>0},enumerable:!0,configurable:!0}),t.prototype._ensureQueryEngine=function(e){var t=this;if(!this.active)return this.clear(),!1;if(this._queryEngine)return!0;var i,r=this._core.owner.loadedGraphics,s=n.featureGeometryTypeKebabDictionary.toJSON(this.featureGeometryType),a=new Array(r.length),o=0;return r.forEach(function(e){a[++o]=t._convertToOptimizedFeature(e),i=i||e.geometry.spatialReference}),this._store=new y.default({geometryType:s,hasM:!1,hasZ:!1}),this._store.addMany(a),this._queryEngine=new f.default({hasZ:!1,hasM:!1,geometryType:s,fields:[],timeInfo:this._timeInfo,spatialReference:i,objectIdField:this._objectIdField,featureStore:this._store,scheduler:this._scheduler,priority:4}),e.madeProgress(),!0},t.prototype._needsUpdate=function(){return this._dirty&&!this._querying||null!=this._queryResult},t.prototype._update=function(e){var t=this;if(this._ensureQueryEngine(e)){if(this._dirty&&!this._querying&&!e.done){this._querying=!0,this.dirty=!1;var i=this._layerView.filter?this._layerView.filter.toJSON():{};this._queryEngine.executeQueryForIdSet(i).then(function(e){t._queryResult=e,t._querying=!1}).catch(function(e){g.warn("FeatureFilter query failed: "+e),t._queryResult=new Set,t._core.forEachGraphics3DGraphic(function(e){return t._queryResult.add(t._getFeatureId(e.graphic)),!1}),t._querying=!1}),e.madeProgress()}this._queryResult&&!e.done&&(this._core.forEachGraphics3DGraphic(function(i){if(e.done)return!1;var r=t._queryResult.has(t._getFeatureId(i.graphic));return!!i.setVisibilityFlag(2,r,0)&&(e.madeProgress(),!0)}),e.done||(this._queryResult=null)),this.notifyChange("updating")}else this.dirty=!1},t.prototype._convertToOptimizedFeature=function(e){var t=e.geometry;if("mesh"===t.type||"extent"===t.type){var i=h.fromExtent("mesh"===t.type?t.extent:t);return i.hasZ=!1,i.hasM=!1,new d.default(c.convertFromGeometry(i),e.attributes,null,this._getFeatureId(e))}return c.convertFromFeature(e,u.getJsonType(e.geometry),!1,!1,this._objectIdField)},t.prototype._getFeatureId=function(e){return null==e.objectId?e.attributes[this._objectIdField]:e.objectId},Object.defineProperty(t.prototype,"dirty",{set:function(e){this._dirty!==e&&(this._dirty=e,this.notifyChange("updating"))},enumerable:!0,configurable:!0}),r([p.property({readOnly:!0})],t.prototype,"updating",null),r([p.property({constructOnly:!0})],t.prototype,"geometryType",void 0),r([p.property({readOnly:!0,dependsOn:["geometryType"]})],t.prototype,"featureGeometryType",null),r([p.subclass("esri.views.3d.layers.graphics.Graphics3DFilterVisibility")],t)}(p.declared(s));t.Graphics3DFilterVisibility=m}.apply(null,r))||(e.exports=n)},1697:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(22),i(25),i(97),i(13),i(9),i(21),i(0),i(128),i(1698),i(1636),i(1507),i(1637),i(1534)],void 0===(n=function(e,t,i,r,n,s,a,o,l,p,h,u,c,d,y,f,g){return function(e){function t(t){var i=e.call(this)||this;return i.controller=null,i.asyncGraphicsUpdates=!1,i.suspendResumeExtentMode="computed",i.slicePlaneEnabled=!1,i.supportsDraping=!0,i.overlayUpdating=!1,i.fullExtentInLocalViewSpatialReference=null,i.suspendResumeExtent=null,i._queryEngine=null,i._controllerCreated=!1,i.clippingExtent=null,i.supportsHeightUnitConversion=!0,i.pendingController=null,i}return i(t,e),t.prototype.initialize=function(){var e=this;this.layer.isTable?this.addResolvingPromise(l.reject(new o("featurelayerview:table-not-supported","table feature layer can't be displayed",{layer:this.layer}))):(this._set("graphics3d",new f({owner:this,layer:this.layer,frustumVisibilityEnabled:!0,scaleVisibilityEnabled:!0,filterVisibilityEnabled:!0,elevationAlignmentEnabled:!0,elevationFeatureExpressionEnabled:!0,asyncGraphicsUpdates:this.asyncGraphicsUpdates,suspendResumeExtentMode:this.suspendResumeExtentMode,updateClippingExtent:function(t){return e.updateClippingExtent(t)}})),this.handles.add([this.watch("asyncGraphicsUpdates",function(t){e.graphics3d.graphicsCore.asyncUpdates=t}),this.watch("suspendResumeExtentMode",function(t){e.graphics3d.suspendResumeExtentMode=t})]),this.drawingOrder=this.view.getDrawingOrder(this.layer.uid),this.addResolvingPromise(this.graphics3d.setup().then(function(){return e.validateGeometryType()}).then(function(){return g.toViewIfLocal(e)}).then(function(t){return e.fullExtentInLocalViewSpatialReference=t}).then(function(){return e.initializeController()})),this.notifyChange("updating"))},t.prototype.destroy=function(){this.destroyPendingController(),this.controller&&(this.controller.destroy(),this.controller=null),this.graphics3d&&(this.graphics3d.destroy(),this._set("graphics3d",null)),this.loadedGraphics=null,this._queryEngine&&this._queryEngine.destroy(),this._queryEngine=null},t.prototype.destroyPendingController=function(){this.pendingController&&(this.pendingController.destroy(),this.pendingController=null)},Object.defineProperty(t.prototype,"drawingOrder",{set:function(e){this.graphics3d.graphicsCore.setDrawingOrder(e),this._set("drawingOrder",e)},enumerable:!0,configurable:!0}),t.prototype.getRenderingInfo=function(e,t){var i=d.getRenderingInfo(e,{renderer:t});if(i&&i.color){var r=i.color;r[0]=r[0]/255,r[1]=r[1]/255,r[2]=r[2]/255}return i},t.prototype.getGraphicFromGraphicUid=function(e){var t=this,i=null;return this.loadedGraphics&&this.loadedGraphics.forEach(function(r){r.uid===e&&(i=u.hydrateGraphic(r,t.layer))}),i},Object.defineProperty(t.prototype,"graphics3DGraphics",{get:function(){return this.graphics3d?this.graphics3d.graphicsCore.graphics3DGraphics:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"graphics3DGraphicsByObjectID",{get:function(){return this.graphics3d?this.graphics3d.graphicsCore.graphics3DGraphicsByObjectID:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"symbolUpdateType",{get:function(){return this.graphics3d?this.graphics3d.graphicsCore.symbolUpdateType:null},enumerable:!0,configurable:!0}),t.prototype.whenGraphicBounds=function(e,t){return this.graphics3d?this.graphics3d.graphicsCore.whenGraphicBounds(e,t):null},t.prototype.whenSymbolLayerSize=function(e,t){return this.graphics3d?a.safeCast(this.graphics3d.graphicsCore.whenSymbolLayerSize(e,t)):null},t.prototype.queryFeatures=function(e){return this._queryEngine?this._queryEngine.queryFeatures(e):this._rejectQuery()},t.prototype.queryObjectIds=function(e){return this._queryEngine?this._queryEngine.queryObjectIds(e):this._rejectQuery()},t.prototype.queryFeatureCount=function(e){return this._queryEngine?this._queryEngine.queryFeatureCount(e):this._rejectQuery()},t.prototype.queryExtent=function(e){return this._queryEngine?this._queryEngine.queryExtent(e):this._rejectQuery()},t.prototype.highlight=function(e,t){return void 0===t&&(t={}),this.graphics3d.highlight(e,t,this.layer.objectIdField)},t.prototype.getStats=function(){var e=this.graphics3d.graphicsCore.getStats();return e.features=this.loadedGraphics.length,e.updating=this.updating,e.elevationUpdating=this.graphics3d.elevationAlignment.updating,e.visibilityFrustum=!this.graphics3d.frustumVisibility.suspended,e.visibilityScale=!this.graphics3d.scaleVisibility.suspended,e},t.prototype.canResume=function(){return!(!this.inherited(arguments)||this.graphics3d&&this.graphics3d.suspended)},t.prototype.isUpdating=function(){return!(!this.graphics3d||this.graphics3d.destroyed)&&(!this._controllerCreated||this.controller&&this.controller.updating||this.overlayUpdating||!this.view.basemapTerrain||!this.view.basemapTerrain.ready||this.graphics3d.updating)},t.prototype.initializeController=function(){return s(this,void 0,void 0,function(){var e;return n(this,function(t){switch(t.label){case 0:return[4,this.createController()];case 1:return e=t.sent(),this.pendingController=e,[4,e.when()];case 2:return t.sent(),this.setControllerWhenInitialized(e),[2]}})})},t.prototype.setControllerWhenInitialized=function(e){return s(this,void 0,void 0,function(){return n(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.when()];case 1:return t.sent(),[3,3];case 2:return t.sent(),[3,3];case 3:return this._controllerCreated=!0,this.notifyChange("updating"),this.isResolved()?[4,p.whenTrueOnce(this.view,"basemapTerrain.ready")]:(this.destroyPendingController(),[2]);case 4:return t.sent(),this.pendingController=null,this.controller=e,this.loadedGraphics=e.graphics,this._queryEngine=new c({layer:this.layer,features:this.loadedGraphics,objectIdField:this.layer.objectIdField,dataSpatialReference:this.view.spatialReference}),this.notifyChange("updating"),[2]}})})},t.prototype.updateClippingExtent=function(e){if(this.clippingExtent=e,!this.controller)return!1;switch(this.controller.type){case"stream":return!1;case"feature-tile-3d":return this.controller.extent=e,!0}},t.prototype.validateGeometryType=function(){var e=this.layer;switch(e.geometryType){case"multipatch":case"multipoint":return l.reject(new o("featurelayerview3d:unsupported-geometry-type","Unsupported geometry type ${geometryType}",{geometryType:e.geometryType}))}},t.prototype._rejectQuery=function(){return l.reject(new o("featurelayerview3d:query","Not ready to execute query"))},r([h.property()],t.prototype,"loadedGraphics",void 0),r([h.property({dependsOn:["graphics3d.suspended"]})],t.prototype,"suspended",void 0),r([h.property({dependsOn:["graphics3d.updating","controller.updating","overlayUpdating"]})],t.prototype,"updating",void 0),r([h.property()],t.prototype,"controller",void 0),r([h.property()],t.prototype,"graphics3d",void 0),r([h.property({readOnly:!0})],t.prototype,"asyncGraphicsUpdates",void 0),r([h.property({readOnly:!0})],t.prototype,"suspendResumeExtentMode",void 0),r([h.property({type:Boolean})],t.prototype,"slicePlaneEnabled",void 0),r([h.property({aliasOf:"graphics3d.graphicsCore.hasDraped"})],t.prototype,"hasDraped",void 0),r([h.property({readOnly:!0,type:Boolean})],t.prototype,"supportsDraping",void 0),r([h.property({type:Boolean})],t.prototype,"overlayUpdating",void 0),r([h.property()],t.prototype,"drawingOrder",null),r([h.subclass("esri.views.3d.layers.FeatureLikeLayerView3D")],t)}(h.declared(y))}.apply(null,r))||(e.exports=n)},1698:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(43),i(6),i(13),i(9),i(0),i(37),i(128),i(1464)],void 0===(n=function(e,t,i,r,n,s,a,o,l,p,h,u){var c=function(e){function t(t){var i=e.call(this)||this;return i.features=null,i.layer=null,i.objectIdField=null,i.dataSpatialReference=null,i}return i(t,e),t.prototype.queryFeatures=function(e){var t=this;return this._queryFeatures(e).then(function(e){var i=e.map(function(e){return h.hydrateGraphic(e,t.layer)});return new u({features:i,fields:t.layer?t.layer.fields.slice():null,geometryType:t.layer?t.layer.geometryType:null,spatialReference:t.dataSpatialReference?t.dataSpatialReference.clone():null})})},t.prototype.queryObjectIds=function(e){var t=this;return this.objectIdField?this.queryFeatures(e).then(function(e){return t._getObjectIds(e.features)}):this._rejectQuery("Unsupported query")},t.prototype.queryFeatureCount=function(e){return this.features&&!e?o.resolve(this.features.length):this._queryFeatures(e).then(function(e){return e.length})},t.prototype.queryExtent=function(e){var t=this;return this.queryFeatures(e).then(function(e){return{count:e.features.length,extent:t._getExtent(e.features)}})},t.prototype._queryFeatures=function(e){if(this.features){if(e){if(this._isSupportedQuery(e)){var t=this._createFilters(e);return t.length?this._executeQuery(e,t):this._rejectQuery("Invalid query")}return this._rejectQuery("Unsupported query")}return this._returnAllFeatures()}return this._rejectQuery("Engine not initialized")},t.prototype._returnAllFeatures=function(){return o.resolve(this.features.toArray())},t.prototype._executeQuery=function(e,t){var i=this,r=[];return this.features.forEach(function(n){t.every(function(t){return t.call(i,n,e)})&&r.push(n)}),o.resolve(r)},t.prototype._isSupportedQuery=function(e){var t=!0;return(null!=e.distance||null!=e.geometryPrecision||e.groupByFieldsForStatistics&&e.groupByFieldsForStatistics.length||null!=e.maxAllowableOffset||e.multipatchOption||null!=e.num||e.orderByFields&&e.orderByFields.length||e.outFields&&e.outFields.length||e.outSpatialReference||e.outStatistics&&e.outStatistics.length||e.pixelSize||e.quantizationParameters||e.relationParameter||e.returnDistinctValues||null!=e.start||e.text||e.timeExtent||e.where||e.objectIds&&e.objectIds.length&&!this.objectIdField)&&(t=!1),t},t.prototype._createFilters=function(e){var t=[];return e.objectIds&&e.objectIds.length&&t.push(this._createObjectIdFilter()),e.geometry&&"extent"===e.geometry.type&&"intersects"===e.spatialRelationship&&t.push(this._createExtentFilter()),t},t.prototype._createExtentFilter=function(){return function(e,t){var i=e.geometry;if(!i)return!1;var r=t.geometry;return p.fromExtent(r,d),h.computeAABR(i,y),p.intersects(d,y)}},t.prototype._createObjectIdFilter=function(){var e=this;return function(t,i){var r=t.attributes,n=r&&r[e.objectIdField];return i.objectIds.indexOf(n)>-1}},t.prototype._rejectQuery=function(e){return o.reject(new a(this.declaredClass,e))},t.prototype._getObjectIds=function(e){var t=this.objectIdField,i=[];return e.forEach(function(e){var r=e.attributes,n=r&&r[t];null!=n&&i.push(n)}),i},t.prototype._getExtent=function(e){if(0===e.length)return null;p.empty(d);for(var t=0;t<e.length;t++){var i=e[t].geometry;h.computeAABR(i,y),p.expand(d,y,d)}return new n.Extent({xmin:d[0],ymin:d[1],xmax:d[2],ymax:d[3],spatialReference:e[0].geometry.spatialReference})},r([l.property()],t.prototype,"features",void 0),r([l.property({constructOnly:!0})],t.prototype,"layer",void 0),r([l.property()],t.prototype,"objectIdField",void 0),r([l.property()],t.prototype,"dataSpatialReference",void 0),r([l.subclass("esri.layers.graphics.QueryEngine")],t)}(l.declared(s)),d=p.create(),y=p.create();return c}.apply(null,r))||(e.exports=n)},2255:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(22),i(25),i(79),i(26),i(9),i(0),i(1697),i(2256)],void 0===(n=function(e,t,r,n,s,a,o,l,p,h,u,c){return function(e){function t(){return e.call(this)||this}return r(t,e),t.prototype.createController=function(){return a(this,void 0,void 0,function(){var e,t,r;return s(this,function(n){switch(n.label){case 0:return e=l.ofType(o),[4,p.create(function(e){i.e(82).then(function(){var t=[i(2279)];e.apply(null,t)}.bind(this)).catch(i.oe)})];case 1:return t=n.sent(),[4,(r=new t({layer:this.layer,layerView:this,graphics:new e})).when()];case 2:return n.sent(),[2,r]}})})},n([h.property()],t.prototype,"controller",void 0),n([h.property({aliasOf:"controller.graphics",readOnly:!0})],t.prototype,"graphics",void 0),n([h.subclass("esri.views.3d.layers.StreamLayerView3D")],t)}(h.declared(u,c))}.apply(null,r))||(e.exports=n)},2256:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(6),i(13),i(17),i(9),i(21),i(0),i(556)],void 0===(n=function(e,t,i,r,n,s,a,o,l,p,h){return function(e){function t(){var t=e.call(this)||this;return t._handles=new a,t.connectionError=null,t.connectionStatus="disconnected",t.filter=null,t._handles.add(l.on(t,"controller","data-received",function(e){t.emit("data-received",e)})),t}return i(t,e),t.prototype.connect=function(){return this.controller.connection.connect()},t.prototype.disconnect=function(){this.controller.connection.disconnect()},t.prototype.updateFilter=function(e){return"connected"!==this.connectionStatus?o.reject(new s("stream-layer-view: updateFilter","Cannot update filter. The connection with the stream service is closed")):this.controller.updateFilter(e)},r([p.property({aliasOf:"controller.connection.connectionError",readOnly:!0})],t.prototype,"connectionError",void 0),r([p.property({aliasOf:"controller.connection.connectionStatus",readOnly:!0})],t.prototype,"connectionStatus",void 0),r([p.property()],t.prototype,"controller",void 0),r([p.property({type:h})],t.prototype,"filter",void 0),r([p.subclass("esri.views.layers.StreamLayerView")],t)}(p.declared(n))}.apply(null,r))||(e.exports=n)}}]);