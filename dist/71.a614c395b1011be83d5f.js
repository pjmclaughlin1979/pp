(function(){(this||window).webpackJsonp.registerAbsMids({"esri/views/2d/engine/webgl/rendererInfoUtils":1701,"esri/views/2d/layers/features/tileRenderers/BaseTileRenderer":1715,"esri/views/2d/layers/features/tileRenderers/SymbolTileRenderer":2275,"esri/views/2d/engine/webgl/WGLFeatureView":2276})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{1701:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(11),i(79),i(155),i(81),i(1505),i(1621)],void 0===(n=function(e,t,i,r,n,a,l,o){Object.defineProperty(t,"__esModule",{value:!0});var s=new n;function u(e,t,i){if(!e)return null;var n=0,l={},o=e.clone(),u=o.visualVariables,f=null;if("simple"!==o.type&&"dot-density"!==o.type){var p=o.field,c=o.valueExpression;if(!p&&c){var d="$$fake"+n++,h=a.createFunction(c);l[d]=function(e,r){return s.repurposeFromGraphicLikeObject(e.geometry,e.attributes,i),a.executeFunction(h,{vars:{$feature:s,$view:a.getViewInfo(r)},spatialReference:t})},o.field=d,o.valueExpression=null,f=function(e,t){return t.attributes[d]=l[d](t),e.valueExpression?e.getSymbol(r.fromJSON(t)):e.getSymbol(t)}}}return u&&(o.visualVariables=u.map(function(e){var r="size"===e.type&&e.valueExpression&&"$view.scale"===e.valueExpression;if(e.normalizationField){var o=e.field,u=e.normalizationField,f="$$fake"+n++;return l[f]=function(e,t){return e.attributes[o]/e.attributes[u]},(p=e.clone()).field=f,p.normalizationField=null,p}if(!e.valueExpression||r)return e;var p,c=e.valueExpression,d=(f="$$fake"+n++,a.createFunction(c));return l[f]=function(e,r){return s.repurposeFromGraphicLikeObject(e.geometry,e.attributes,i),a.executeFunction(d,{vars:{$feature:s,$view:a.getViewInfo(r)},spatialReference:t})},(p=e.clone()).field=f,p.valueExpression=null,p})),{renderer:o,normalizingFunctions:l,getSymbolFunction:f}}t.createRendererInfo=function(e,t,i){var r=u(e,t,i)||{renderer:null,normalizingFunctions:null,getSymbolFunction:null},n=r&&r.normalizingFunctions,a=r&&r.getSymbolFunction;e=r&&r.renderer||e;var l=o.convertVisualVariables(e.visualVariables);return{renderer:e,vvFields:l.vvFields,vvRanges:l.vvRanges,getValue:function(e,t){var i=n[t];return i?i(e):e.attributes[t]},getSymbol:function(e){return a?a(this.renderer,e):this.renderer.getSymbol?this.renderer.getSymbol.call(this.renderer,e):null}}},t.getNormalizedRenderer=function(e,t,i){var r=u(e,t,i)||{renderer:null,normalizingFunctions:null,getSymbolFunction:null};return r&&r.renderer||e},t.getSymbol=function(e,t){return e.getSymbol(t)},t.isRendererWebGLCompatible=function(e){if(!e)return!1;if(-1===["simple","class-breaks","unique-value","heatmap"].indexOf(e.type))return!1;if("visualVariables"in e&&e.visualVariables)for(var t=0,i=e.visualVariables;t<i.length;t++){var r=i[t];switch(r.type){case"color":case"opacity":if(r.stops&&8<r.stops.length)return!1;break;case"size":if(o.getTypeOfSizeVisualVariable(r)===l.WGLVVFlag.SIZE_FIELD_STOPS&&r.stops&&6<r.stops.length)return!1}}return!0}}.apply(null,r))||(e.exports=n)},1715:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(6),i(1503),i(0)],void 0===(n=function(e,t,i,r,n,a,l){Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){var i=e.call(this)||this;return i.tiles=new Map,i.layer=null,i}return i(t,e),t.prototype.destroy=function(){this.tiles.clear(),this.layer=this.layerView=this.tileInfoView=this.configuration=this.tiles=null},Object.defineProperty(t.prototype,"updating",{get:function(){return this.isUpdating()},enumerable:!0,configurable:!0}),t.prototype.acquireTile=function(e){var t=this,i=this.createTile(e);return i.once("isReady",function(){return t.notifyChange("updating")}),this.tiles.set(e.id,i),i},t.prototype.forEachTile=function(e){this.tiles.forEach(e)},t.prototype.releaseTile=function(e){this.tiles.delete(e.key.id),this.disposeTile(e)},t.prototype.isUpdating=function(){var e=!0;return this.tiles.forEach(function(t){e=e&&t.isReady}),!e},t.prototype.requestUpdate=function(){this.layerView.requestUpdate()},r([l.property()],t.prototype,"configuration",void 0),r([l.property()],t.prototype,"layer",void 0),r([l.property()],t.prototype,"layerView",void 0),r([l.property()],t.prototype,"tileInfoView",void 0),r([l.property()],t.prototype,"updating",null),r([l.subclass()],t)}(l.declared(n,a));t.default=o}.apply(null,r))||(e.exports=n)},2275:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(11),i(359),i(6),i(10),i(32),i(14),i(0),i(37),i(555),i(81),i(1701),i(1621),i(2276),i(1618),i(1715)],void 0===(n=function(e,t,i,r,n,a,l,o,s,u,f,p,c,d,h,v,y,g,b){function w(e){for(var t in e.diff){var i=e.diff[t];if("partial"===i.type&&w(i))return!0;if("complete"===i.type&&"valueExpression"===t)return!0}return!1}function V(e){if(!("visualVariables"in e&&e.visualVariables&&e.visualVariables.length))return e;var t=e.clone(),i=t.visualVariables.map(function(e){return function(e){return("size"===e.type||"color"===e.type||"opacity"===e.type)&&null!=e.stops}(e)?function(e){return e.stops=function(e,t){return t.length<=_?t:(I.warn("Found "+t.length+" Visual Variable stops, but MapView only supports "+_+". Displayed stops will be simplified."),t.length>2*_?function(e,t){for(var i=t[0],r=t.slice(1),n=r.pop(),a=r[0].value,l=r[r.length-1].value,o=(l-a)/T,s=[],f=a;f<l;f+=o){for(var p=0;f>=r[p].value;)p++;var c=r[p],d=t[p-1],h=f-d.value,v=c.value===d.value?1:h/(c.value-d.value);if("color"===e){var y=r[p],g=t[p-1],b=y.color.clone();b.r=m(g.color.r,b.r,v),b.g=m(g.color.g,b.g,v),b.b=m(g.color.b,b.b,v),b.a=m(g.color.a,b.a,v),s.push({value:f,color:b,label:y.label})}else if("size"===e){var w=r[p],V=t[p-1],I=u.toPt(w.size),_=u.toPt(V.size),F=m(_,I,v);s.push({value:f,size:F,label:w.label})}else{var L=r[p],R=t[p-1],S=m(R.opacity,L.opacity,v);s.push({value:f,opacity:S,label:L.label})}}return[i].concat(s,[n])}(e,t):function(e){for(var t=e[0],i=e.slice(1),r=i.pop();i.length>T;){for(var n=0,a=0,l=1;l<i.length;l++){var o=i[l-1],s=i[l],u=Math.abs(s.value-o.value);u>a&&(a=u,n=l)}i.splice(n,1)}return[t].concat(i,[r])}(t))}(e.type,e.stops),e}(e):e});return t.visualVariables=i,t}function m(e,t,i){return(1-i)*e+i*t}Object.defineProperty(t,"__esModule",{value:!0});var I=o.getLogger("esri.views.2d.layers.features.tileRenderer.SymbolTileRenderer"),_=8,T=_-2,F=function(e){function t(t){return e.call(this)||this}return i(t,e),t.prototype.createTile=function(e){var t=p.create();return this.tileInfoView.getTileBounds(t,e),new g(e,t)},t.prototype.disposeTile=function(e){this.featuresView.removeChild(e)},t.prototype.updateHighlight=function(){this.featuresView.updateHighlight()},t.prototype.hitTest=function(e,t){return this.featuresView.hitTest(e,t)},t.prototype.supportsRenderer=function(e){return null!=e&&-1!==["simple","class-breaks","unique-value","dot-density"].indexOf(e.type)},t.prototype.getProcessorConfiguration=function(){var e=this.layer,t=e.definitionExpression,i=e.gdbVersion,r=e.historicMoment,n=e.labelingInfo,a=this.layerView.availableFields,l=V(this.layer.renderer);return{type:"symbol",renderer:l.toJSON(),devicePixelRatio:window.devicePixelRatio||1,definitionExpression:t,availableFields:a,gdbVersion:i,historicMoment:r&&r.getTime(),labelingInfo:n&&n.map(function(e){return e.toJSON()}),hasGeometryExpr:d.hasGeometryOperations(l)||n&&n.some(function(e){return d.hasGeometryOperations(e)})}},t.prototype.needsProcessorReconfiguration=function(e){var t=this.wouldClear(e),i=this.configuration;return this.configuration=e,t||i.definitionExpression!==e.definitionExpression},t.prototype.wouldClear=function(e){var t=this.configuration;if(!t||t.availableFields.join()!==e.availableFields.join()||c.diff(t.labelingInfo,e.labelingInfo))return!0;var i=this.configuration&&a.fromJSON(this.configuration.renderer)||null,r=e&&a.fromJSON(e.renderer)||null;if(r&&"dot-density"===r.type)return(i&&i.getControllerHash())!==(r&&r.getControllerHash());var n=c.diff(i,r);if(s.isNone(n))return!1;switch(n.type){case"complete":return!0;case"partial":if(function(e){for(var t in e.diff){var i=e.diff[t];if("collection"===i.type){if(0!==i.changed.length||0!==i.added.length||0!==i.removed.length)return!0}else{if("visualVariables"!==t&&"authoringInfo"!==t)return!0;if("visualVariables"===t){if("complete"===i.type)return!0;if(w(i))return!0}}}return!1}(n))return!0;if(n.diff.visualVariables){var l=this.featuresView.visualVariablesInfo,o=this.tileInfoView.tileInfo.spatialReference,u={fields:this.layer.fields.map(function(e){return e.toJSON()})},f=h.getNormalizedRenderer(r,o,u),p=v.convertVisualVariables(f.visualVariables).vvFields;return!!c.diff(l.vvFields,p)}}},t.prototype.clear=function(){this.featuresView.disposeWebGLResources()},t.prototype.applyConfiguration=function(e){var t=a.fromJSON(e.renderer),i={fields:this.layer.fields.map(function(e){return e.toJSON()})},r=h.getNormalizedRenderer(t,this.tileInfoView.tileInfo.spatialReference,i);this.configuration=e,this.featuresView.visualVariablesInfo=v.convertVisualVariables(r.visualVariables)},t.prototype.install=function(e){var t=new y.default({tileInfoView:this.tileInfoView,layer:this.layer,layerView:this.layerView});this.featuresView=t,e.addChild(t)},t.prototype.uninstall=function(e){e.removeChild(this.featuresView),this.featuresView=null},t.prototype.onTileData=function(e){var t=this.tiles.get(e.tileKey);t&&this.featuresView.onTileData(t,e.data)},t.prototype.onTileError=function(e){var t=this.tiles.get(e.tileKey);t&&this.featuresView.onTileError(t)},t.prototype.getMaterialItems=function(e){return this.featuresView.getMaterialItems(e)},t.prototype.setFilterFlag=function(e,t,i,r){this.featuresView.setFilterFlag(e,t,i,r)},r([f.subclass()],t)}(f.declared(l,b.default));t.default=F}.apply(null,r))||(e.exports=n)},2276:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(11),i(5),i(32),i(9),i(9),i(31),i(1510),i(1616),i(1505),i(1511),i(1614)],void 0===(n=function(e,t,i,r,n,a,l,o,s,u,f,p,c){Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){function t(t){var i=e.call(this)||this;return i._rendererInfo=new c,i._pointToCallbacks=new Map,i._invisibleFeatures=new Set,i._displayWidth=0,i._displayHeight=0,i.layer=null,i.tileInfoView=t.tileInfoView,i.layer=t.layer,i._layerView=t.layerView,i}return r(t,e),t.prototype.dispose=function(){this.removeAllChildren();for(var e=0,t=this.children;e<t.length;e++)t[e].dispose()},t.prototype.disposeWebGLResources=function(){for(var e=0,t=this.children;e<t.length;e++)t[e].clear()},t.prototype.displayWidth=function(){return this._displayWidth},Object.defineProperty(t.prototype,"displayHeight",{get:function(){return this._displayHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visualVariablesInfo",{get:function(){return this._visualVariablesInfo},set:function(e){this._visualVariablesInfo=e,this.requestRender()},enumerable:!0,configurable:!0}),t.prototype.hitTest=function(e,t){var i=this,r=[e,t];return a.create(function(e,t){i._pointToCallbacks.set(r,{resolve:e,reject:t}),i.requestRender()},function(){i._pointToCallbacks.has(r)&&i._pointToCallbacks.delete(r)})},t.prototype.setFilterFlag=function(e,t,i,r){if(void 0===r&&(r=!0),r){t||(t=[]),i||(i=[]);for(var n=this._invisibleFeatures,a=0,l=t;a<l.length;a++){var o=l[a];n.has(o)&&n.delete(o)}for(var s=0,u=i;s<u.length;s++){var f=u[s];n.add(f)}for(var p=0,c=this.children;p<c.length;p++)(v=c[p]).data&&v.setFilterFlag(0,t,i)}else for(var d=0,h=this.children;d<h.length;d++){var v;(v=h[d]).data&&v.setFilterFlag(e,t,i)}},t.prototype.whenAttached=function(){var e=this;return this.attached?a.resolve():a.create(function(t){return e.once("attached",function(){return t()})})},t.prototype.getMaterialItems=function(e){var t=this;return this.whenAttached().then(function(){var i=e;if(t.stage&&i&&0!==i.length){for(var r=[],n=t.stage.painter.textureManager,a=0,o=i;a<o.length;a++){var s=o[a];r.push(n.rasterizeItem(s.symbol,s.glyphIds))}return l.all(r).then(function(t){return t.map(function(t,i){return{id:e[i].id,mosaicItem:t}})})}})},t.prototype.onTileData=function(e,t){var r=!(!this.layer.labelingInfo||!this.layer.labelingInfo.length),n=t.addOrUpdate&&u.decode(t.addOrUpdate),a=i({},t,{addOrUpdate:n});e.setData(a,r,this.layer.labelsVisible),e.resetVisibility(this._invisibleFeatures),e.buildHLList(this._layerView.highlightIDs),this.contains(e)||this.addChild(e),this.requestRender(),this._layerView&&this._layerView.view.labelManager.requestUpdate()},t.prototype.onTileError=function(e){e.clear(),e.buildHLList(this._layerView.highlightIDs),this.contains(e)||this.addChild(e),this.requestRender()},t.prototype.addChild=function(t){var i=e.prototype.addChild.call(this,t);return this.layer.labelingInfo&&this._layerView&&this._layerView.view.labelManager.addTile(this.layer.uid,t),this._buildHLList(),i},t.prototype.removeChild=function(t){var i=e.prototype.removeChild.call(this,t);return this.layer.labelingInfo&&this._layerView&&this._layerView.view.labelManager.removeTile(this.layer.uid,t.key.id),this._buildHLList(),i},t.prototype.renderChildren=function(e){var t=this,r=this.stage.painter;this._updateTilesTransform(e.state,this.tileInfoView.getClosestInfoForScale(e.state.scale).level),this._rendererInfo.update(e.state,this.layer.renderer,this._visualVariablesInfo.vvRanges,this._layerView.effects);var a=this.tileInfoView.getClosestInfoForScale(e.state.scale).level,l=this.tileInfoView.tileInfo.scaleToZoom(e.state.scale),o=i({},e,{rendererInfo:this._rendererInfo,requiredLevel:a,displayLevel:l,context:this.stage.context,painter:this.stage.painter});this.sortChildren(function(e,t){return e.key.level-t.key.level!=0?e.key.level-t.key.level:e.key.row-t.key.row!=0?e.key.row-t.key.row:e.key.col-t.key.col});var s=o.drawPhase;if(s&(f.WGLDrawPhase.LABEL|f.WGLDrawPhase.LABEL_ALPHA)){var u=this.layer;if(!(u.labelsVisible&&u.labelingInfo&&0<u.labelingInfo.length))return;this._updateTilesTransform(o.state,o.requiredLevel)}r.draw(o,this.children,s,this._painterOptions),0<this._layerView.highlightIDs.size&&r.highlight(o,this.children),this._pointToCallbacks.forEach(function(e,i){e.resolve(t._hitTest(o,i[0],i[1]))}),this._pointToCallbacks.clear(),this._layerView.effects&&this._layerView.effects.some(function(e){return n.isSome(e)&&!e.done})&&this.requestRender()},t.prototype.updateHighlight=function(){this._buildHLList()},t.prototype._hitTest=function(e,t,i){var r=this.stage,n=r.painter,a=r.context,l=e.requiredLevel,s=[0,0];e.state.toMap(s,[t,i]);var u=e.state.clone(),c=u.viewpoint.clone();return c.targetGeometry=new o(s[0],s[1],e.state.spatialReference),u.viewpoint=c,u.size=[p.C_HITTEST_SEARCH_SIZE,p.C_HITTEST_SEARCH_SIZE],this._updateTilesTransform(u,l),n.hitTest({globalOpacity:1,painter:n,context:a,drawPhase:f.WGLDrawPhase.HITTEST,pixelRatio:e.pixelRatio,displayLevel:e.displayLevel,rendererInfo:this._rendererInfo,requiredLevel:l,state:u,stationary:e.stationary},this.children)},t.prototype._updateTilesTransform=function(e,t){for(var i=0,r=this.children;i<r.length;i++){var n=r[i],a=this.tileInfoView.tileInfo.lods[n.key.level].resolution,l=a/(e.resolution*e.pixelRatio);n.setTransform(e,l),n.setLabelTransform(e,a)}},t.prototype._buildHLList=function(){for(var e=0,t=this.children;e<t.length;e++)t[e].buildHLList(this._layerView.highlightIDs);this.requestRender()},t}(s.Container);t.default=d}.apply(null,r))||(e.exports=n)}}]);