(function(){(this||window).webpackJsonp.registerAbsMids({"esri/views/2d/engine/webgl/WGLRendererInfo":1614,"esri/views/2d/engine/webgl/TileData":1616,"esri/views/2d/engine/webgl/WGLTile":1618,"esri/views/2d/engine/webgl/WGLDisplayList":1731,"esri/views/2d/engine/webgl/MemoryRequirements":2012,"esri/views/2d/engine/webgl/TileBufferData":2013,"esri/views/2d/engine/webgl/TileDisplayData":2014,"esri/views/2d/engine/webgl/util/Reader":2016,"esri/views/2d/engine/webgl/DirtyMap":2017,"esri/views/2d/engine/webgl/DisplayRecordStore":2018,"esri/views/2d/engine/webgl/FreeList":2019,"esri/views/2d/engine/webgl/Fader":2020,"esri/views/2d/engine/webgl/WGLBuffers":2021})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{1614:function(e,t,r){var i,a;i=[r.dj.c(e.i),t,r(32),r(14),r(82),r(264),r(280),r(1506),r(1511)],void 0===(a=function(e,t,r,i,a,n,o,s,l){function f(e,t){var r=t.length;if(e<t[0].value||1===r)return t[0].size;for(var i=1;i<r;i++)if(e<t[i].value){var a=(e-t[i-1].value)/(t[i].value-t[i-1].value);return t[i-1].size+a*(t[i].size-t[i-1].size)}return t[r-1].size}function u(e,t,r){void 0===r&&(r=0);var i=t.r,a=t.g,n=t.b,o=t.a;e[r+0]=i*o/255,e[r+1]=a*o/255,e[r+2]=n*o/255,e[r+3]=o}var d=function(e,t,r){for(var i=16*r,a=i,n=0;a<Math.min(i+16,e.length);a++,n++)e[a]=t[n]},p=n.mat4f32.create(),y=n.mat4f32.fromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return function(){function e(){this.symbolLevels=[],this.vvColorValues=new Float32Array(8),this.vvColors=new Float32Array(32),this.vvOpacityValues=new Float32Array(8),this.vvOpacities=new Float32Array(8),this.vvSizeMinMaxValue=new Float32Array(4),this.vvSizeFieldStopsValues=new Float32Array(6),this.vvSizeFieldStopsSizes=new Float32Array(6),this.ddColors=new Float32Array(32),this.ddBackgroundColor=new Float32Array(4),this.insideEffect=new Float32Array(16*s.MAX_FILTERS),this.outsideEffect=new Float32Array(16*s.MAX_FILTERS),this.effectCount=0,this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1},this.symbolLevels.push(0),d(this.insideEffect,p,0),d(this.outsideEffect,y,0);for(var e=1;e<s.MAX_FILTERS;e++)d(this.insideEffect,p,e),d(this.outsideEffect,p,e)}return Object.defineProperty(e.prototype,"vvMaterialParameters",{get:function(){return this._vvMaterialParameters},enumerable:!0,configurable:!0}),e.prototype.update=function(e,t,i,a){var n=this;switch(r.isSome(a)?(a.forEach(function(e,t){return n._updateEffects(t,e)}),this.effectCount=a.length):this.effectCount=0,i&&this._updateVisualVariables(i,e),t.type){case"dot-density":this._updateDotDensityInfo(t.attributes),this.ddDotValue=t.referenceDotValue,this.ddDotScale=t.referenceScale,this.ddDotSize=t.dotSize,this.ddDotBlending=t.blendDots,this.ddSeed=t.seed,u(this.ddBackgroundColor,t.backgroundColor)}},e.prototype.getVariation=function(){return{ddDotBlending:this.ddDotBlending,outsideLabelsVisible:this.outsideLabelsVisible,effectCount:this.effectCount}},e.prototype.getVariationHash=function(){return(this.ddDotBlending?1:0)|(this.outsideLabelsVisible?1:0)<<1|this.effectCount<<2},e.prototype._updateEffects=function(e,t){var i=e+1;if(r.isSome(t)&&t.filter&&t.filter.enabled){this.outsideLabelsVisible=t.excludedLabelsVisible;var a=t.parsedIncludedEffect,n=t.parsedExcludedEffect;r.isSome(a)?d(this.insideEffect,a.getColorMatrix(),i):d(this.insideEffect,p,i),r.isSome(n)?d(this.outsideEffect,n.getColorMatrix(),i):d(this.outsideEffect,p,i)}else d(this.insideEffect,p,i),d(this.outsideEffect,p,i)},e.prototype._updateVisualVariables=function(e,t){var r=this._vvMaterialParameters;if(r.vvOpacityEnabled=!1,r.vvSizeEnabled=!1,r.vvColorEnabled=!1,r.vvRotationEnabled=!1,e){var n=e.size;if(n){if(r.vvSizeEnabled=!0,n.minMaxValue){var s=n.minMaxValue,u=void 0,d=void 0;if(l.isDefined(s.minSize)&&l.isDefined(s.maxSize))if(l.isNumber(s.minSize)&&l.isNumber(s.maxSize))u=i.pt2px(s.minSize),d=i.pt2px(s.maxSize);else{var p=t.scale;u=i.pt2px(f(p,s.minSize.stops)),d=i.pt2px(f(p,s.maxSize.stops))}this.vvSizeMinMaxValue.set([s.minDataValue,s.maxDataValue,u,d])}if(n.scaleStops&&(this.vvSizeScaleStopsValue=i.pt2px(f(t.scale,n.scaleStops.stops))),n.unitValue){var y=a.getMetersPerUnitForSR(t.spatialReference)/o.meterIn[n.unitValue.unit];this.vvSizeUnitValueToPixelsRatio=y/t.resolution}n.fieldStops&&(this.vvSizeFieldStopsValues.set(n.fieldStops.values),this.vvSizeFieldStopsSizes.set(n.fieldStops.sizes))}var c=e.color;c&&(r.vvColorEnabled=!0,this.vvColorValues.set(c.values),this.vvColors.set(c.colors));var v=e.opacity;v&&(r.vvOpacityEnabled=!0,this.vvOpacityValues.set(v.values),this.vvOpacities.set(v.opacities));var h=e.rotation;h&&(r.vvRotationEnabled=!0,r.vvRotationType=h.type)}},e.prototype._updateDotDensityInfo=function(e){for(var t=this.ddColors,r=0;r<Math.min(s.DOT_DENSITY_MAX_FIELDS,e.length);r++)u(t,e[r].color,4*r)},e}()}.apply(null,i))||(e.exports=a)},1616:function(e,t,r){var i,a;i=[r.dj.c(e.i),t,r(2012),r(2013),r(2014),r(1511),r(1511),r(1662),r(1568),r(1733),r(2016),r(1617),r(1664)],void 0===(a=function(e,t,r,i,a,n,o,s,l,f,u,d,p){var y=new r.default,c=new r.default;function v(e,t){var r={};for(var i in e){var a={data:o.allocateTypedArrayBuffer(t,e[i]),stride:e[i]};r[i]=a}return r}return function(){function e(){this.tileDisplayData=null,this.tileBufferData=null}return e.prototype.reshuffle=function(){y.reset();for(var t=a.groupRecordsByGeometryType(this.tileDisplayData.displayObjects),r=0,s=t;r<s.length;r++)for(var l=0,f=D=s[r];l<f.length;l++)(F=f[l])&&y.needMore(F.geometryType,F.meshData?F.meshData.vertexCount:F.vertexCount,F.meshData?F.meshData.indexData.length:F.indexCount);for(var u=t.length,d=new i,p=0;p<u;++p){d.geometries[p].indexBuffer=new Uint32Array(Math.round(1.15*y.indicesFor(p)));var v=[];for(var h in this.tileBufferData.geometries[p].vertexBuffer)v.push(this.tileBufferData.geometries[p].vertexBuffer[h].stride);var m=e._computeVertexAlignment(v),g=Math.round(1.15*y.verticesFor(p)),x=e._align(g,m);for(var _ in this.tileBufferData.geometries[p].vertexBuffer){var b=this.tileBufferData.geometries[p].vertexBuffer[_].stride;d.geometries[p].vertexBuffer[_]={stride:b,data:o.allocateTypedArrayBuffer(x,b)}}}for(c.reset(),this.tileDisplayData.displayList.clear(),p=0;p<u;++p){for(var D,L=0,B=D=t[p];L<B.length;L++){var F;if((F=B[L]).meshData)F.writeMeshDataToBuffers(c.verticesFor(p),d.geometries[p].vertexBuffer,c.indicesFor(p),d.geometries[p].indexBuffer),F.meshData=null;else{var T=this.tileBufferData.geometries[p].vertexBuffer,w=this.tileBufferData.geometries[p].indexBuffer,R=d.geometries[p].vertexBuffer,C=d.geometries[p].indexBuffer,I=c.verticesFor(p),M=c.indicesFor(p);n.copyMeshData(I,M,R,C,F,T,w),F.vertexFrom=I,F.indexFrom=M}c.needMore(p,F.vertexCount,F.indexCount)}this.tileDisplayData.displayList.unified||this.tileDisplayData.displayList.addToList(D)}if(this.tileDisplayData.displayList.unified)for(var O=0,j=this.tileDisplayData.displayObjects;O<j.length;O++){var S=j[O];this.tileDisplayData.displayList.addToList(S.displayRecords)}this.tileBufferData=d},e.prototype.getStrides=function(){for(var e=[],t=0;t<this.tileBufferData.geometries.length;++t){var r=this.tileBufferData.geometries[t];for(var i in e[t]={},r.vertexBuffer)e[t][i]=r.vertexBuffer[i].stride}return e},e.prototype.clone=function(){var t=new e;return t.tileBufferData=this.tileBufferData.clone(),t.tileDisplayData=this.tileDisplayData.clone(),t},e.prototype._guessSize=function(){for(var e=this.tileDisplayData.displayObjects,t=Math.min(e.length,4),r=0,i=0;i<t;i++)r=Math.max(r,e[i].displayRecords.length);return 2*(12*e.length+e.length*r*40)},e.prototype.serialize=function(){var e=this.tileBufferData.serialize(),t=this.tileBufferData.getBuffers(),r=this.tileDisplayData.serialize(new p.default(Int32Array,this._guessSize())).buffer();return t.push(r),{result:{displayData:r,bufferData:e},transferList:t}},e.decode=function(t){var r=d.deserializeList(new u.default(t.displayObjects),s),i={};for(var a in t.vertexBuffersMap)i[a]=f.VertexBuffers.decode(t.vertexBuffersMap[a]);return e.fromMeshData({displayObjects:r,vertexBuffersMap:i})},e.fromMeshData=function(t){var r=new e,n=new a.default,o=new i;for(var s in n.displayObjects=t.displayObjects,t.vertexBuffersMap){var l=t.vertexBuffersMap[s];o.geometries[s].indexBuffer=l.indexBuffer,o.geometries[s].vertexBuffer=l.namedBuffers}return r.tileDisplayData=n,r.tileBufferData=o,r},e.bind=function(t,r){var i=new e;return i.tileDisplayData=t,i.tileBufferData=r,i},e.create=function(t,r){var n=new e;n.tileDisplayData=new a.default;for(var o=[0,0,0,0,0],s=[0,0,0,0,0],f=[[],[],[],[],[]],u=0,d=n.tileDisplayData.displayObjects=t;u<d.length;u++)for(var p=0,y=d[u].displayRecords;p<y.length;p++){var c=y[p];f[c.geometryType].push(c),o[c.geometryType]+=c.meshData.vertexCount,s[c.geometryType]+=c.meshData.indexData.length}for(var h,m=new i,g=[(h=r).fill||{},h.line||{},h.icon||{},h.text||{},h.label||{}],x=0;x<5;x++){var _=new Uint32Array(s[x]),b=v(g[x],o[x]);l.writeAllMeshDataToBuffers(f[x],b,_),m.geometries[x]={indexBuffer:_,vertexBuffer:b}}return n.tileBufferData=m,n},e._align=function(e,t){var r=e%t;return 0===r?e:e+(t-r)},e._computeVertexAlignment=function(e){for(var t=!1,r=!1,i=0,a=e;i<a.length;i++){var n=a[i];n%4==2?t=!0:n%4!=0&&(r=!0)}return r?4:t?2:1},e}()}.apply(null,i))||(e.exports=a)},1618:function(e,t,r){var i,a;i=[r.dj.c(e.i),t,r(5),r(267),r(563),r(91),r(565),r(40),r(212),r(548),r(1506),r(2017),r(2018),r(1505),r(2020),r(1522),r(1511),r(2021),r(1731),r(352)],void 0===(a=function(e,t,r,i,a,n,o,s,l,f,u,d,p,y,c,v,h,m,g,x){function _(e,t){return e.sortKey-t.sortKey}var b=new Set;return function(e){function t(t,r,i){void 0===i&&(i=!1);var n=e.call(this)||this;return n._data=null,n.hlDisplayList=null,n._displayList=null,n._wglBuffers=null,n._dirtyMap=new d.default,n.coords=[0,0],n.bounds=[0,0,0,0],n.dvsMat3=o.mat3f32.create(),n.tileMat3=o.mat3f32.create(),n.labelMat2d=a.mat2df32.create(),n._labelIndex=null,n._dirty=!0,n.fader=new c.default,n.key=x.pool.acquire(t),n.coords[0]=r[0],n.coords[1]=r[3],n.bounds=r,n._ensureCorrectZOrder=i,n}return r(t,e),Object.defineProperty(t.prototype,"displayObjects",{get:function(){return this._data.tileDisplayData.displayObjects},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canDisplay",{get:function(){return!!this.attached},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDirty",{get:function(){return this._dirty},set:function(e){(this._dirty=e)||this.isReady||this.ready(),this.requestRender()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasData",{get:function(){return!!this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelIndex",{get:function(){return this._labelIndex},enumerable:!0,configurable:!0}),t.prototype.getGeometry=function(e){return this._wglBuffers&&this._wglBuffers.has(e)?this._wglBuffers.get(e):null},t.prototype.getDisplayList=function(e){switch(e){case y.WGLDrawPhase.HIGHLIGHT:return this.hlDisplayList;default:return this._data&&this._displayList}},Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),t.prototype.setData=function(e,t,r){var i=e.addOrUpdate,a=e.remove;if(this.fader.reset(),(e.clear||!this.hasData)&&!e.addOrUpdate)return this.clear(),void this.ready();!e.clear&&this.hasData||!e.addOrUpdate?this.hasData&&this._doPatchData({addOrUpdate:i,remove:a},t,r):(i.tileDisplayData.computeDisplayList(this._ensureCorrectZOrder),this._dirtyMap=new d.default,this._dispRecStore=p.default.fromTileData(i,this._dirtyMap),this._data=i,this._readyTileIfNoLabels(t,r),this._dirtyMap.markAllDirty(),this._displayList||(this._displayList=i.tileDisplayData.displayList.clone()))},t.prototype.commitChanges=function(e){this.isDirty&&this._wglBuffers||(this._wglBuffers||(this._wglBuffers=new m.default(this.stage.context)),this._displayList=this._data.tileDisplayData.displayList.clone(),this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap),this._dirtyMap.markAllClean())},t.prototype.resetVisibility=function(e){var t=this,r=new Array(0),i=new Array(1);e.forEach(function(e){i[0]=e,t.setFilterFlag(0,r,i)})},t.prototype.setFilterFlag=function(e,t,r){if(this.hasData){for(var i=1<<e,a=this._data.tileBufferData.geometries.map(h.geometryToMappedGeometry),n=0,o=t;n<o.length;n++){var s=o[n];if(v=this._data.tileDisplayData.displayObjectRegistry.get(s)){v.setFilterFlag(e,!0);for(var l=0,f=v.displayRecords;l<f.length;l++)if(b=(B=a[(_=f[l]).geometryType]).geometry.vertexBuffer[h.C_VBO_VISIBILITY]){B.vertexFrom=null==B.vertexFrom?_.vertexFrom:Math.min(B.vertexFrom,_.vertexFrom),B.vertexTo=null==B.vertexTo?_.vertexFrom+_.vertexCount:Math.max(B.vertexTo,_.vertexFrom+_.vertexCount);for(var u=_.vertexFrom,d=_.vertexCount,p=0;p<d;++p)b.data[u+p]|=i}}}for(var y=0,c=r;y<c.length;y++){var v,m=c[y];if(v=this._data.tileDisplayData.displayObjectRegistry.get(m)){v.setFilterFlag(e,!1);for(var g=0,x=v.displayRecords;g<x.length;g++){var _,b;if(b=(B=a[(_=x[g]).geometryType]).geometry.vertexBuffer[h.C_VBO_VISIBILITY])for(B.vertexFrom=null==B.vertexFrom?_.vertexFrom:Math.min(B.vertexFrom,_.vertexFrom),B.vertexTo=null==B.vertexTo?_.vertexFrom+_.vertexCount:Math.max(B.vertexTo,_.vertexFrom+_.vertexCount),u=_.vertexFrom,d=_.vertexCount,p=0;p<d;++p)b.data[u+p]&=~i}}}for(var D=!1,L=0;L<a.length;++L){var B;if(null!=(B=a[L]).vertexFrom&&null!=B.vertexTo){var F=B.vertexTo?B.vertexTo-B.vertexFrom:0;this._dirtyMap.markDirtyVertices(L,h.C_VBO_VISIBILITY,B.vertexFrom,F),D=!0}}D&&this.requestRender()}},t.prototype.setVisibilityRange=function(e,t,r,i){for(var a=this._data.tileDisplayData.displayObjectRegistry.get(e),n=this._data.tileBufferData.geometries[y.WGLGeometryType.LABEL].vertexBuffer[h.C_VBO_VISIBILITY_RANGE],o=1/0,s=0,l=t;l<t+r;++l){for(var f=a.displayRecords[l],u=Math.max(f.minZoom,i),d=f.maxZoom,p=v.i8888to32(u,d,u,d),c=f.vertexFrom*n.stride/4,m=f.vertexCount*n.stride/4,g=c;g<c+m;++g)n.data[g]=p;o=Math.min(o,f.vertexFrom),s=Math.max(s,f.vertexFrom+f.vertexCount)}var x=s-o;this._dirtyMap.markDirtyVertices(y.WGLGeometryType.LABEL,h.C_VBO_VISIBILITY_RANGE,o,x)},t.prototype.setTransform=function(e,t){var r=this.tileMat3,i=e.toScreenNoRotation([0,0],this.coords),a=i[0],o=i[1],s=t;n.mat3.set(this.tileMat3,s,0,0,0,s,0,a,o,1),n.mat3.multiply(this.dvsMat3,e.displayViewMat3,r)},t.prototype.setLabelTransform=function(e,t){var r=this.labelMat2d,a=e.getScreenTransform(r,t),n=l.vec2f32.create();s.vec2.transformMat2d(n,this.coords,a),i.mat2d.identity(r),i.mat2d.translate(r,r,n),i.mat2d.multiply(r,e.viewMat2d,r)},t.prototype.clear=function(){this._data=null,this._displayList=null,this._dispRecStore=null,this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null),this.hlDisplayList&&(this.hlDisplayList=null)},t.prototype.attach=function(){return!0},t.prototype.dispose=function(){this.clear()},t.prototype.doRender=function(e){if(this.isReady&&this.hasData){if(this.commitChanges(e),this.stage.context.setStencilFunction(514,this.stencilRef,255),e.drawPhase===y.WGLDrawPhase.MAP||e.drawPhase===y.WGLDrawPhase.LABEL||e.drawPhase===y.WGLDrawPhase.LABEL_ALPHA)this._displayList.replay(e,this);else for(var t=0,r=this.stage.painter.getBrushes(e.drawPhase);t<r.length;t++)r[t].draw(e,this);this.fader.step()||this.requestRender()}},t.prototype.buildHLList=function(e){var t=this;this.hlDisplayList=new g,e.forEach(function(e){t._addToHLDisplayList(t.hlDisplayList,e)})},t.prototype._addToHLDisplayList=function(e,t){if(this._data){var r=this._data.tileDisplayData.displayObjectRegistry.get(t);if(r){for(var i=[],a=0,n=r.displayRecords;a<n.length;a++){var o=n[a].copy();o.meshData=null,o.symbolLevel=0,o.zOrder=0,i.push(o)}i.sort(_),e.addToList(i)}}},t.prototype._readyTileIfNoLabels=function(e,t){this.isDirty=!(!e||!t||(this._rebuildLabelIndex(),0))},t.prototype._doPatchData=function(e,t,r){this._patchData(e)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=p.default.fromTileData(this._data,this._dirtyMap)),this._readyTileIfNoLabels(t,r),this.requestRender()},t.prototype._rebuildLabelIndex=function(){this._labelIndex=this._initLabelIndex();for(var e=0,t=this.displayObjects;e<t.length;e++)for(var r=0,i=t[e].metrics;r<i.length;r++){var a=i[r];this._insertIntoLabelIndex(a)}},t.prototype._insertIntoLabelIndex=function(e){-1!==e.xBucket&&this.labelIndex[e.yBucket][e.xBucket].push(e)},t.prototype._initLabelIndex=function(){for(var e=[],t=0;t<u.TILE_SIZE/u.COLLISION_BUCKET_SIZE;t++){e.push([]);for(var r=0;r<u.TILE_SIZE/u.COLLISION_BUCKET_SIZE;r++)e[t].push([])}return e},t.prototype._patchData=function(e){for(var t=!0,r=e.addOrUpdate&&e.addOrUpdate.tileDisplayData&&e.addOrUpdate.tileDisplayData.displayObjects||[],i=(e.remove||[]).slice(),a=0,n=r;a<n.length;a++)null!=(h=n[a]).insertAfter&&i.push(h.id);for(var o=0,s=i;o<s.length;o++){var l=s[o];if(v=this._data.tileDisplayData.displayObjectRegistry.get(l)){this._data.tileDisplayData.displayList.removeFromList(v.displayRecords);for(var f=0,u=v.displayRecords;f<u.length;f++){var d=u[f];this._dispRecStore.delete(d)}this._data.tileDisplayData.displayObjectRegistry.delete(l);var p=this._data.tileDisplayData.displayObjects.indexOf(v);this._data.tileDisplayData.displayObjects.splice(p,1)}}for(var y=0,c=r;y<c.length;y++){var v,h=c[y],m=void 0;if(v=this._data.tileDisplayData.displayObjectRegistry.get(h.id)){var g=v.displayRecords;v.set(h),v.displayRecords=g;for(var x=v.displayRecords.length,_=0;_<x;++_){var D=v.displayRecords[_],L=h.displayRecords[_];(_>=h.displayRecords.length||D.geometryType!==L.geometryType||D.symbolLevel!==L.symbolLevel||D.zOrder!==L.zOrder||D.materialKey!==L.materialKey)&&(this._dispRecStore.delete(v.displayRecords[_]),_<h.displayRecords.length&&(v.displayRecords[_]=void 0))}v.displayRecords.length=h.displayRecords.length,v.metrics=h.metrics}else{(v=h.copy()).displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(h.id,v);var B=void 0,F=this._data.tileDisplayData.displayObjects;if(null!=v.insertAfter)if(m={},0<=v.insertAfter){var T=this._data.tileDisplayData.displayObjectRegistry.get(v.insertAfter);T&&(B=F.indexOf(T)+1)<F.length?F.splice(B,0,v):(F.push(v),B=F.length)}else F.unshift(v),B=0;else F.push(v),B=F.length;if(m){var w=void 0;if(this._data.tileDisplayData.displayList.unified)w=0<h.displayRecords.length?1:0;else{b.clear();for(var R=0,C=h.displayRecords;R<C.length;R++){var I=C[R],M=this._data.tileDisplayData.displayList.getDPInfoType(I.geometryType);b.add(M)}w=b.size}var O=0;for(_=B-1;0<=_&&O<w;--_)for(var j=F[_].displayRecords.length-1;0<=j&&O<w;--j){var S=F[_].displayRecords[j];m[M=this._data.tileDisplayData.displayList.getDPInfoType(S.geometryType)]||(m[M]=S,++O)}}}var A=h.displayRecords.length;for(_=0;_<A;++_){L=h.displayRecords[_],(D=v.displayRecords[_])?(D.meshData=L.meshData,D.materialKey=L.materialKey):((D=L.copy()).vertexFrom=void 0,D.indexFrom=void 0,v.displayRecords[_]=D);var P=L.geometryType,G=(M=this._data.tileDisplayData.displayList.getDPInfoType(P),e.addOrUpdate.tileBufferData.geometries[P]),z=G.vertexBuffer,E=G.indexBuffer,V=void 0;m&&(V=m[M]?this._data.tileDisplayData.displayList.splitAfter(m[M]):-1),t=this._dispRecStore.setMeshData(D,L,z,E,V)&&t,m&&null!=D.indexFrom&&null!=D.indexFrom&&(m[M]=D)}}return t},t}(f.DisplayObject)}.apply(null,i))||(e.exports=a)},1731:function(e,t,r){var i,a;i=[r.dj.c(e.i),t,r(22),r(10),r(1505)],void 0===(a=function(e,t,r,i,a){var n=i.getLogger("esri.views.2d.engine.webgl.WGLDisplayList");function o(e,t,r){for(var i=[],a=3;a<arguments.length;a++)i[a-3]=arguments[a];t<e.length?e.splice.apply(e,[t,r].concat(i)):e.push.apply(e,i)}var s=new Map;s.set(a.WGLDrawPhase.MAP,[a.WGLGeometryType.FILL,a.WGLGeometryType.LINE,a.WGLGeometryType.MARKER,a.WGLGeometryType.TEXT]),s.set(a.WGLDrawPhase.LABEL,[a.WGLGeometryType.LABEL]),s.set(a.WGLDrawPhase.LABEL_ALPHA,[a.WGLGeometryType.LABEL]);var l=function(){function e(e){void 0===e&&(e=!1),this.symbolLevels=[],this.unified=e}return e.prototype.replay=function(e,t){if(this.unified)for(var r=0,i=this.symbolLevels;r<i.length;r++)for(var a=0,n=i[r].zLevels;a<n.length;a++){var o=n[a].geometryDPInfo;for(var l in o)if(o[l])for(var f=0,u=o[l];f<u.length;f++){var d=u[f],p=e.painter.getGeometryBrush(d.geometryType),y=t.getGeometry(d.geometryType);p.drawGeometry(e,t,d,y)}}else for(var c=function(r){var i=e.painter.getGeometryBrush(r),a=t.getGeometry(r);v.byType(r,function(r){i.drawGeometry(e,t,r,a)})},v=this,h=0,m=s.get(e.drawPhase);h<m.length;h++)c(m[h])},Object.defineProperty(e.prototype,"empty",{get:function(){return!this.symbolLevels||0===this.symbolLevels.length},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this.symbolLevels.length=0},e.prototype.addToList=function(e,t){if(Array.isArray(e))for(var r=0,i=e;r<i.length;r++){var a=i[r];this._addToList(a,t)}else this._addToList(e,t)},e.prototype.removeFromList=function(e){Array.isArray(e)||(e=[e]);for(var t=null,r=0,i=e;r<i.length;r++){var a=i[r];t=this._removeFromList(a)}return t},e.prototype.byType=function(e,t){for(var r=0,i=this.symbolLevels;r<i.length;r++)for(var a=0,n=i[r].zLevels;a<n.length;a++){var o=n[a].geometryDPInfo,s=this.getDPInfoType(e);if(o[s])for(var l=0,f=o[s];l<f.length;l++)t(f[l])}},e.prototype.clone=function(){for(var t=new e(this.unified),r=0,i=this.symbolLevels;r<i.length;r++){var a=i[r];t.symbolLevels.push(a.clone())}return t},e.prototype.splitAfter=function(e){for(var t=this._getDisplayList(e.symbolLevel,e.zOrder,e.geometryType),r=t.length,i=e.indexFrom+e.indexCount,a=0;a<r;++a){var n=t[a];if(n.geometryType===e.geometryType&&i>n.indexFrom&&i<=n.indexFrom+n.indexCount){if(i<n.indexFrom+n.indexCount){var o=new f;o.geometryType=n.geometryType,o.materialKey=n.materialKey,o.indexFrom=i,o.indexCount=n.indexFrom+n.indexCount-i,t.splice(a+1,0,o),n.indexCount=i-n.indexFrom}return a}}},e.prototype._addToList=function(e,t){var r=e.symbolLevel,i=e.zOrder,a=this._getDisplayList(r,i,e.geometryType),n=null!=t?t:a.length-1,s=0<=n&&n<a.length?a[n]:null;if(null===s||s.materialKey!==e.materialKey||s.indexFrom+s.indexCount!==e.indexFrom||this.unified&&s.geometryType!==e.geometryType){var l=new f;l.indexFrom=e.indexFrom,l.indexCount=e.indexCount,l.materialKey=e.materialKey,l.geometryType=e.geometryType,o(a,n+1,0,l)}else s.indexCount+=e.indexCount},e.prototype._removeFromList=function(e){for(var t=e.symbolLevel,r=e.zOrder,i=this._getDisplayList(t,r,e.geometryType),a=i.length,n=void 0,s=0;s<a;++s){var l=i[s];if(e.indexFrom+e.indexCount>l.indexFrom&&e.indexFrom<l.indexFrom+l.indexCount&&(!this.unified||l.geometryType===e.geometryType)){n=s;break}}if(void 0===n)return null;if(l=i[n],e.indexFrom===l.indexFrom)return l.indexCount-=e.indexCount,l.indexFrom+=e.indexCount,0===l.indexCount&&o(i,n,1),n-1;if(e.indexFrom+e.indexCount===l.indexFrom+l.indexCount)return l.indexCount-=e.indexCount,0===l.indexCount?(o(i,n,1),n-1):n;var u=l.indexFrom,d=e.indexFrom-l.indexFrom,p=e.indexCount,y=l.indexFrom+l.indexCount-(e.indexFrom+e.indexCount);l.indexCount=d;var c=new f;return c.geometryType=l.geometryType,c.materialKey=l.materialKey,c.indexFrom=u+d+p,c.indexCount=y,o(i,n+1,0,c),n},e.prototype._getDisplayList=function(e,t,r){for(var i,n,o=this.symbolLevels.length,s=0;s<o;s++)if(this.symbolLevels[s].symbolLevel===e){i=this.symbolLevels[s];break}i||((i=new p).symbolLevel=e,this.symbolLevels.push(i));for(var l,f=i.zLevels.length,y=0;y<f;y++)if(i.zLevels[y].zLevel===t){n=i.zLevels[y];break}if(n||((n=new d).geometryDPInfo=new u,n.zLevel=t,i.zLevels.push(n)),this.unified)n.geometryDPInfo.unified||(n.geometryDPInfo.unified=[]),l=n.geometryDPInfo.unified;else switch(r){case a.WGLGeometryType.FILL:n.geometryDPInfo.fill||(n.geometryDPInfo.fill=[]),l=n.geometryDPInfo.fill;break;case a.WGLGeometryType.LINE:n.geometryDPInfo.line||(n.geometryDPInfo.line=[]),l=n.geometryDPInfo.line;break;case a.WGLGeometryType.MARKER:n.geometryDPInfo.marker||(n.geometryDPInfo.marker=[]),l=n.geometryDPInfo.marker;break;case a.WGLGeometryType.TEXT:n.geometryDPInfo.text||(n.geometryDPInfo.text=[]),l=n.geometryDPInfo.text;break;case a.WGLGeometryType.LABEL:n.geometryDPInfo.label||(n.geometryDPInfo.label=[]),l=n.geometryDPInfo.label;break;default:console.error("Trying to add a record with geometry type '"+r+"'.")}return l},e.prototype.getDPInfoType=function(e){if(this.unified)return"unified";switch(e){case a.WGLGeometryType.FILL:return"fill";case a.WGLGeometryType.LINE:return"line";case a.WGLGeometryType.MARKER:return"marker";case a.WGLGeometryType.TEXT:return"text";case a.WGLGeometryType.LABEL:return"label";default:n.error("DisplayList: Tried to convert unknown geometryType: "+e)}},e}(),f=function(){function e(){this.materialKey=null,this.indexFrom=0,this.indexCount=0}return e.prototype.clone=function(){var t=new e;return t.geometryType=this.geometryType,t.materialKey=this.materialKey,t.indexFrom=this.indexFrom,t.indexCount=this.indexCount,t},e}(),u=function(){function e(){this.fill=null,this.line=null,this.marker=null,this.text=null,this.label=null,this.unified=null}return e.prototype.clone=function(){var t=new e;return t.fill=this.fill&&this.fill.map(function(e){return e.clone()}),t.line=this.line&&this.line.map(function(e){return e.clone()}),t.marker=this.marker&&this.marker.map(function(e){return e.clone()}),t.text=this.text&&this.text.map(function(e){return e.clone()}),t.label=this.label&&this.label.map(function(e){return e.clone()}),t.unified=this.unified&&this.unified.map(function(e){return e.clone()}),t},e}(),d=function(){function e(){this.geometryDPInfo=new u}return e.prototype.clone=function(){var t=new e;return t.zLevel=this.zLevel,t.geometryDPInfo=this.geometryDPInfo.clone(),t},e}(),p=function(){function e(){this.zLevels=[]}return e.prototype.clone=function(){var t=new e;t.symbolLevel=this.symbolLevel;for(var r=0,i=this.zLevels;r<i.length;r++){var a=i[r];t.zLevels.push(a.clone())}return t},e}();return l}.apply(null,i))||(e.exports=a)},2012:function(e,t,r){var i,a;i=[r.dj.c(e.i),t],void 0===(a=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._byGeometryType=null}return Object.defineProperty(e.prototype,"satisfied",{get:function(){return!this._byGeometryType},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this._byGeometryType=null},e.prototype.verticesFor=function(e){return this._byGeometryType?this._byGeometryType[e].vertices:0},e.prototype.indicesFor=function(e){return this._byGeometryType?this._byGeometryType[e].indices:0},e.prototype.needMore=function(e,t,r){if(t||r){this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]);var i=this._byGeometryType[e];i.vertices+=t,i.indices+=r}},e}();t.default=r}.apply(null,i))||(e.exports=a)},2013:function(e,t,r){var i,a;i=[r.dj.c(e.i),t,r(1511)],void 0===(a=function(e,t,r){return function(){function e(){this.geometries=[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}return e.prototype.clone=function(){for(var t=new e,r=0;r<this.geometries.length;r++){var i=this.geometries[r],a=t.geometries[r];for(var n in a.indexBuffer=i.indexBuffer.slice(),a.vertexBuffer={},i.vertexBuffer){var o=i.vertexBuffer[n],s=o.data,l=o.stride;a.vertexBuffer[n]={data:s.slice(),stride:l}}}return t},e.deserialize=function(t){for(var i=new e,a=0;a<5;++a)for(var n in i.geometries[a].indexBuffer=new Uint32Array(t.geometries[a].indexBuffer),i.geometries[a].vertexBuffer={},t.geometries[a].vertexBuffer)i.geometries[a].vertexBuffer[n]={data:r.allocateTypedArrayBufferwithData(t.geometries[a].vertexBuffer[n].data,t.geometries[a].vertexBuffer[n].stride),stride:t.geometries[a].vertexBuffer[n].stride};return i},e.prototype.serialize=function(){for(var e={geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]},t=0;t<5;++t)for(var r in this.geometries[t].vertexBuffer)e.geometries[t].vertexBuffer[r]={data:this.geometries[t].vertexBuffer[r].data.buffer,stride:this.geometries[t].vertexBuffer[r].stride};return e},e.prototype.getBuffers=function(){for(var e=[],t=0;t<5;++t)for(var r in e.push(this.geometries[t].indexBuffer.buffer),this.geometries[t].vertexBuffer)e.push(this.geometries[t].vertexBuffer[r].data.buffer);return e},e}()}.apply(null,i))||(e.exports=a)},2014:function(e,t,r){var i,a;i=[r.dj.c(e.i),t,r(1731),r(1662),r(1617)],void 0===(a=function(e,t,r,i,a){function n(e){for(var t=[[],[],[],[],[]],r=0,i=e;r<i.length;r++)for(var a=0,n=i[r].displayRecords;a<n.length;a++){var o=n[a];t[o.geometryType].push(o)}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.groupRecordsByGeometryType=n;var o=function(){function e(){}return Object.defineProperty(e.prototype,"displayObjectRegistry",{get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(var e=0,t=this.displayObjects;e<t.length;e++){var r=t[e];this._displayObjectRegistry.set(r.id,r)}}return this._displayObjectRegistry},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayList",{get:function(){return this._displayList},enumerable:!0,configurable:!0}),e.prototype.computeDisplayList=function(e){if(this._displayList=new r(e),e)for(var t=0,i=this.displayObjects;t<i.length;t++)for(var a=0,o=i[t].displayRecords;a<o.length;a++){var s=o[a];this._displayList.addToList(s)}else for(var l=n(this.displayObjects),f=l.length,u=0;u<f;++u){var d=l[u];this._displayList.addToList(d)}},e.prototype.clone=function(){var t=new e;return this.displayObjects&&(t.displayObjects=this.displayObjects.map(function(e){return e.clone()})),t},e.prototype.serialize=function(e){return a.serializeList(e,this.displayObjects),e},e.prototype._deserializeObjects=function(e){for(var t=e.readInt32(),r=new Array(t),a=new Map,n=0;n<r.length;++n){var o=i.deserialize(e);r[n]=o,a.set(o.id,o)}this.displayObjects=r,this._displayList=null,this._displayObjectRegistry=a},e.deserialize=function(t){var r=new e;return r._deserializeObjects(t),r},e}();t.default=o}.apply(null,i))||(e.exports=a)},2016:function(e,t,r){var i,a;i=[r.dj.c(e.i),t],void 0===(a=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._pos=0,this._buffer=e,this._i32View=new Int32Array(this._buffer),this._f32View=new Float32Array(this._buffer)}return e.prototype.readInt32=function(){return this._i32View[this._pos++]},e.prototype.readF32=function(){return this._f32View[this._pos++]},e}();t.default=r}.apply(null,i))||(e.exports=a)},2017:function(e,t,r){var i,a;i=[r.dj.c(e.i),t,r(1511)],void 0===(a=function(e,t,r){function i(e,t,r){if(!e.allDirty)if(null!=e.from&&null!=e.count){var i=Math.min(e.from,t),a=Math.max(e.from+e.count,t+r)-i;e.from=i,e.count=a}else e.from=t,e.count=r}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){this._dirties=r.createGeometryData(function(e){return{indices:{from:null,count:null,allDirty:!1}}},function(e,t){return{vertices:{from:null,count:null,allDirty:!1}}})}return e.prototype.markAllClean=function(){for(var e=0,t=this._dirties;e<t.length;e++){var r=t[e];for(var i in r.data.indices.from=null,r.data.indices.count=null,r.data.indices.allDirty=!1,r.buffers)r.buffers[i].data.vertices.from=null,r.buffers[i].data.vertices.count=null,r.buffers[i].data.vertices.allDirty=!1}},e.prototype.markAllDirty=function(){for(var e=0,t=this._dirties;e<t.length;e++){var r=t[e];for(var i in r.data.indices.allDirty=!0,r.buffers)r.buffers[i].data.vertices.allDirty=!0}},e.prototype.forEach=function(e){for(var t=0;t<this._dirties.length;++t){var r=this._dirties[t],i={};for(var a in r.buffers){var n=r.buffers[a].data.vertices;(n.allDirty||null!=n.from&&null!=n.count&&0<n.count)&&(i[a]=n)}var o,s=r.data.indices;((o=s.allDirty||null!=s.from&&null!=s.count&&0<s.count?{indices:s,vertices:i}:{indices:null,vertices:i}).indices||0<Object.keys(o).length)&&e(o,t)}},e.prototype.markDirtyIndices=function(e,t,r){i(this._dirties[e].data.indices,t,r)},e.prototype.markDirtyVertices=function(e,t,r,a){i(this._dirties[e].buffers[t].data.vertices,r,a)},e}();t.default=a}.apply(null,i))||(e.exports=a)},2018:function(e,t,r){var i,a;i=[r.dj.c(e.i),t,r(19),r(2019),r(1511)],void 0===(a=function(e,t,r,i,a){Object.defineProperty(t,"__esModule",{value:!0});var n=["FILL","LINE","MARKER","TEXT","LABEL"],o=function(){function e(e,t,r,n){for(var o in this._strides=e,this._displayList=t,this._freeListsAndStorage={},this._dirtyMap=null,this._dirtyMap=r,e)for(var s in this._freeListsAndStorage[o]={vtxFreeList:n?new i.FreeList(n):null,idxFreeList:n?new i.FreeList(n):null,vertexBuffers:{},indexBuffer:n?new Uint32Array(n):null},e[o])this._freeListsAndStorage[o].vertexBuffers[s]={data:n?a.allocateTypedArrayBuffer(n,e[o][s]):null,stride:e[o][s]}}return e.fromTileData=function(t,r){var o=function(e){var t=e.getStrides(),r={};for(var i in t)r[n[i]]=t[i];return r}(t),s=[0,0,0,0,0],l=[0,0,0,0,0],f=[];t.tileDisplayData.displayObjectRegistry.forEach(function(e){f.push(e)});for(var u=0,d=f;u<d.length;u++)for(var p=0,y=d[u].displayRecords;p<y.length;p++){var c=y[p];s[c.geometryType]=Math.max(s[c.geometryType],c.vertexFrom+c.vertexCount),l[c.geometryType]=Math.max(l[c.geometryType],c.indexFrom+c.indexCount)}for(var v=new e(o,t.tileDisplayData.displayList,r,null),h=0;h<t.tileBufferData.geometries.length;++h){var m=s[h],g=l[h],x=t.tileBufferData.geometries[h],_=n[h],b=v._storageFor(_),D=t.tileBufferData.geometries[h].indexBuffer;b.indexBuffer=D,b.idxFreeList=new i.FreeList(D.length),b.idxFreeList.allocate(g);var L=void 0;for(var B in x.vertexBuffer){var F=t.tileBufferData.geometries[h].vertexBuffer[B];b.vertexBuffers[B].data=F.data,b.vertexBuffers[B].stride=F.stride;var T=a.strideToPackingFactor(F.stride),w=F.data.length*T/F.stride;L||(L=w)}b.vtxFreeList=new i.FreeList(L),b.vtxFreeList.allocate(m)}return v},e.prototype.delete=function(e){var t=n[e.geometryType];this._freeVertices(t,e.vertexFrom,e.vertexCount),this._freeIndices(t,e.indexFrom,e.indexCount),this._displayList.removeFromList(e),e.vertexFrom=void 0,e.indexFrom=void 0},e.prototype.setMeshData=function(e,t,r,i,o){var s=n[e.geometryType];e.meshData=null;var l=void 0,f=void 0;void 0===e.vertexFrom?(f=t.vertexCount,l=this._allocateVertices(s,f)):t.vertexCount>e.vertexCount?(this._freeVertices(s,e.vertexFrom,e.vertexCount),f=t.vertexCount,l=this._allocateVertices(s,f)):f=t.vertexCount===e.vertexCount?(l=e.vertexFrom,e.vertexCount):(this._freeVertices(s,e.vertexFrom+t.vertexCount,e.vertexCount-t.vertexCount),l=e.vertexFrom,t.vertexCount);var u=!0,d=void 0,p=void 0,y=void 0;if(void 0===e.indexFrom?(d=o,y=t.indexCount,p=this._allocateIndices(s,y)):t.indexCount>e.indexCount?(d=this._displayList.removeFromList(e),this._freeIndices(s,e.indexFrom,e.indexCount),y=t.indexCount,p=this._allocateIndices(s,y)):y=t.indexCount===e.indexCount?(u=!1,p=e.indexFrom,e.indexCount):(d=this._displayList.removeFromList(e),this._freeIndices(s,e.indexFrom+t.indexCount,e.indexCount-t.indexCount),p=e.indexFrom,t.indexCount),-1===l||-1===p)return-1!==l&&this._freeVertices(s,l,f),-1!==p&&this._freeIndices(s,p,y),e.setMeshDataFromBuffers(t,r,i),e.vertexFrom=void 0,e.vertexCount=0,e.indexFrom=void 0,e.indexCount=0,!1;var c=this._storageFor(s);if(a.copyMeshData(l,p,c.vertexBuffers,c.indexBuffer,t,r,i),e.vertexFrom=l,e.indexFrom=p,e.vertexCount=t.vertexCount,e.indexCount=t.indexCount,this._dirtyMap)for(var v in this._dirtyMap.markDirtyIndices(e.geometryType,e.indexFrom,e.indexCount),r)this._dirtyMap.markDirtyVertices(e.geometryType,v,e.vertexFrom,e.vertexCount);return u&&this._displayList.addToList(e,d),!0},e.prototype._allocateVertices=function(e,t){var r=this._storageFor(e),i=r.vtxFreeList.allocate(t);return-1===i?-1:.5<r.vtxFreeList.fragmentation?-1:i},e.prototype._freeVertices=function(e,t,i){var n=this._storageFor(e);if(n.vtxFreeList.free(t,i),r("esri-feature-tiles-debug"))for(var o in n.vertexBuffers)for(var s=n.vertexBuffers[o].data,l=this._stridesFor(e,o),f=a.strideToPackingFactor(l),u=t*l/f,d=i*l/f,p=u;p<u+d;++p)s[p]=0},e.prototype._freeIndices=function(e,t,i){var a=this._storageFor(e);if(a.idxFreeList.free(t,i),r("esri-feature-tiles-debug"))for(var n=a.indexBuffer,o=t;o<t+i;++o)n[o]=0},e.prototype._allocateIndices=function(e,t){var r=this._storageFor(e),i=r.idxFreeList.allocate(t);return-1===i?-1:.5<r.idxFreeList.fragmentation?-1:i},e.prototype._storageFor=function(e){return this._freeListsAndStorage[e]},e.prototype._stridesFor=function(e,t){return this._strides[e][t]},e}();t.default=o}.apply(null,i))||(e.exports=a)},2019:function(e,t,r){var i,a;i=[r.dj.c(e.i),t],void 0===(a=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._largestRange=null,this._parent=e,this._updateLargestRange()}return Object.defineProperty(e.prototype,"largestRange",{get:function(){return this._largestRange},enumerable:!0,configurable:!0}),e.prototype.rangeCreated=function(e){(!this._largestRange||e.count>this._largestRange.count)&&(this._largestRange=e)},e.prototype.rangeResized=function(e,t,r){e===this._largestRange?e.count<r&&this._updateLargestRange():(!this._largestRange||e.count>this._largestRange.count)&&(this._largestRange=e)},e.prototype.findBestRange=function(e){for(var t=this._parent._freeHead,r=null;null!==t;)t.count>=e&&(!r||t.count-e<r.count-e)&&(r=t),t=t.next;return r},e.prototype.findAdjacentRanges=function(e,t){for(var r=!0,i=!1,a=null,n=this._parent._freeHead;r&&!i;){var o=null!==a?a.from+a.count:0,s=null!==n?n.from:this._parent._size;o<=e&&e+t<=s?i=!(r=!1):null!==n?n=(a=n).next:r=!1}return[a,n]},e.prototype._updateLargestRange=function(){for(var e=null,t=this._parent._freeHead;null!==t;)(!e||t.count>e.count)&&(e=t),t=t.next;this._largestRange=e},e}(),i=function(){function e(e,t){this._allocated=0,this._size=e,this._freeHead=0<e?{from:0,count:e,prev:null,next:null}:null,this._bookKeeper=t||new r(this),this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}return e.prototype.allocate=function(t){var r=this._bookKeeper.findBestRange(t);if(null===r)return-1;var i=r.from,a=r.count;if(r.from+=t,r.count-=t,this._bookKeeper.rangeResized(r,i,a),this._allocated+=t,0===r.count){var n=null!==r.prev?this._freeHead:r.next;e._removeRange(r),this._freeHead=n}return i},e.prototype.free=function(t,r){var i=this._bookKeeper.findAdjacentRanges(t,r),a=i[0],n=i[1],o={from:t,count:r,prev:a,next:n};if(null!==a&&(a.next=o),null!==n&&(n.prev=o),this._bookKeeper.rangeCreated(o),this._allocated-=r,null!==n&&o.from+o.count===n.from){var s=o.from,l=o.count;e._fuse(o,n),e._removeRange(n),this._bookKeeper.rangeResized(o,s,l),this._bookKeeper.rangeResized(n,void 0,0)}null!==a&&a.from+a.count===o.from&&(s=a.from,l=a.count,e._fuse(a,o),e._removeRange(o),this._bookKeeper.rangeResized(a,s,l),this._bookKeeper.rangeResized(o,void 0,0)),this._freeHead=null!==o.prev?this._freeHead:o},Object.defineProperty(e.prototype,"fragmentation",{get:function(){var e=this._size-this._allocated;return 0===e?0:1-this._bookKeeper.largestRange.count/e},enumerable:!0,configurable:!0}),e._removeRange=function(e){null!==e.prev?null!==e.next?(e.prev.next=e.next,e.next.prev=e.prev):e.prev.next=null:null!==e.next&&(e.next.prev=null)},e._fuse=function(e,t){e.count+=t.count,e.next=t.next,t.from+=t.count,t.count=0,null!==t.next&&(t.next.prev=e)},e}();t.FreeList=i}.apply(null,i))||(e.exports=a)},2020:function(e,t,r){var i,a;i=[r.dj.c(e.i),t],void 0===(a=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){void 0===e&&(e=400),this.duration=e,this._lastTime=0,this._elapsed=0,this._value=0,this._finished=!1}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this._lastTime=0,this._elapsed=0,this._value=0},e.prototype.step=function(){var e=performance.now();if(0===this._lastTime)return this._lastTime=e,!(this._value=0);if(this._elapsed>=this.duration)return!0;var t=e-this._lastTime;return this._elapsed+=t,this._lastTime=e,this._value=Math.min(this._elapsed/this.duration,1),!1},e}();t.default=r}.apply(null,i))||(e.exports=a)},2021:function(e,t,r){var i,a;i=[r.dj.c(e.i),t,r(1511),r(59)],void 0===(a=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e){this.geometryMap=r.createGeometryData(function(t){return{indexBuffer:i.createIndex(e,35044),vao:null}},function(t,a){return{vertexBuffer:i.createVertex(e,r.C_VBO_INFO[a])}})}return e.prototype.dispose=function(){for(var e in this.geometryMap){var t=this.geometryMap[e];for(var r in t.data.vao&&t.data.vao.dispose(!1),t.data.indexBuffer&&t.data.indexBuffer.dispose(),t.buffers)t.buffers[r]&&t.buffers[r].data.vertexBuffer.dispose()}},e.prototype.get=function(e){var t=this.geometryMap[e],r={};for(var i in t.buffers)r[i]=t.buffers[i].data.vertexBuffer;return{indexBuffer:t.data.indexBuffer,get vao(){return t.data.vao},set vao(e){t.data.vao=e},vertexBufferMap:r}},e.prototype.has=function(e){return null!=this.geometryMap[e]},e.prototype.upload=function(e,t){var r=this;t.forEach(function(t,i){r._upload(t,i,e)})},e.prototype._upload=function(e,t,r){if(e.indices&&(e.indices.allDirty?this._uploadIndices(r,t):null!=e.indices.from&&null!=e.indices.count&&this._uploadIndices(r,t,e.indices.from,e.indices.count)),e.vertices){var i=e.vertices;for(var a in i){var n=i[a];n.allDirty?this._uploadVertices(r,t,a):null!=n.from&&null!=n.count&&this._uploadVertices(r,t,a,n.from,n.count)}}},e.prototype._uploadVertices=function(e,t,r,i,a){var n=this.geometryMap[t];if(n){var o=e.geometries[t].vertexBuffer[r];if(o){var s=o.stride,l=o.data.buffer;n.buffers[r]&&0<l.byteLength&&(null!=i&&null!=a?n.buffers[r].data.vertexBuffer.setSubData(l,i*s,i*s,(i+a)*s):n.buffers[r].data.vertexBuffer.setData(l))}}},e.prototype._uploadIndices=function(e,t,r,i){var a=this.geometryMap[t];if(a){var n=e.geometries[t].indexBuffer.buffer;a.data.indexBuffer&&0<n.byteLength&&(null!=r&&null!=i?a.data.indexBuffer.setSubData(n,4*r,4*r,4*(r+i)):a.data.indexBuffer.setData(n))}},e}();t.default=a}.apply(null,i))||(e.exports=a)}}]);